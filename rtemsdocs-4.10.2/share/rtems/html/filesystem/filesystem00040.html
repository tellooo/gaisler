<HTML>
<!-- created Dec 13 2011 from syscalls.texi line 1162 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>unmount</TITLE>
<LINK REL="Precedes" HREF="filesystem00041.html">
<LINK REV="Precedes" HREF="filesystem00039.html">
<LINK REV="Subdocument" HREF="filesystem00014.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="filesystem00039.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="filesystem00014.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="filesystem00041.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Filesystem Design Guide</CITE></P>
<H2>4.26: unmount</H2>
<H3>File:</H3>
<P>
unmount.c
</P>
<H3>Processing:</H3>
<P>
This routine will attempt to dismount a mounted filesystem and then free
all resources that were allocated for the management of that filesystem.
</P>
<H3>Development Comments:</H3>
<UL>
<LI>This routine will determine if there are any filesystems currently
mounted under the filesystem that we are trying to dismount. This would
prevent the dismount of the filesystem.

<LI>It will test to see if the current directory is in the filesystem
that we are attempting to dismount. This would prevent the dismount of the
filesystem.

<LI>It will scan all the currently open file descriptors to determine is
there is an open file descriptor to a file in the filesystem that we are
attempting to unmount().

</UL>
<P>
If the above preconditions are met then the following sequence is
performed:
</P>
<OL>
<LI>Call the filesystem specific unmount() function for the filesystem
that contains the mount point. This routine should indicate that the mount
point no longer has a filesystem mounted below it.

<LI>Call the filesystem specific fsunmount_me() function for the mounted
filesystem that we are trying to unmount(). This routine should clean up
any resources that are no longer needed for the management of the file
system being un-mounted.

<LI>Extract the mount table entry for the filesystem that was just
dismounted from the mount table chain.

<LI>Free the memory associated with the extracted mount table entry.

</OL>
<P><HR>
<LINK REL="Precedes" HREF="filesystem00041.html">
<LINK REV="Precedes" HREF="filesystem00039.html">
<LINK REV="Subdocument" HREF="filesystem00014.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="filesystem00039.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="filesystem00014.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="filesystem00041.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Filesystem Design Guide</CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
