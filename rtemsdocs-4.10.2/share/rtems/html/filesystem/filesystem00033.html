<HTML>
<!-- created Dec 13 2011 from syscalls.texi line 827 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>mknod</TITLE>
<LINK REL="Precedes" HREF="filesystem00034.html">
<LINK REV="Precedes" HREF="filesystem00032.html">
<LINK REV="Subdocument" HREF="filesystem00014.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="filesystem00032.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="filesystem00014.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="filesystem00034.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Filesystem Design Guide</CITE></P>
<H2>4.19: mknod</H2>
<H3>File:</H3>
<P>
mknod.c
</P>
<H3>Processing:</H3>
<P>
This function will allow for the creation of the following types of nodes
under the filesystem:
</P>
<UL>
<LI>directories

<LI>regular files

<LI>character devices

<LI>block devices

<LI>fifos

</UL>
<P>
At the present time, an attempt to create a FIFO will result in an ENOTSUP
error to the calling function. This routine is layered the filesystem
specific routines evalformake and mknod. The introduction of a new
filesystem must include its own evalformake and mknod function to support
the generic mknod() function.  Under this condition the generic mknod()
function should accommodate other filesystem types without alteration.
</P>
<H3>Development Comments:</H3>
<P>
Test for nodal types - I thought that this test should look like the
following code:
</P>
<DL><DT><DD>
<PRE>
if ( (mode &amp; S_IFDIR) = = S_IFDIR) ||
     (mode &amp; S_IFREG) = = S_IFREG) ||
     (mode &amp; S_IFCHR) = = S_IFCHR) ||
     (mode &amp; S_IFBLK) = = S_IFBLK) ||
     (mode &amp; S_IFIFO) = = S_IFIFO))
     Set_errno_and_return_minus_one (EINVAL);

</PRE>
</DL>
<P>
Where:
</P>
<UL>
<LI>S_IFREG (0100000) - Creation of a regular file
<LI>S_IFCHR (0020000) - Creation of a character device
<LI>S_IFBLK (0060000) - Creation of a block device
<LI>S_IFIFO (0010000) - Creation of a FIFO
</UL>

<P>
Determine if the pathname that we are trying to create starts at the root
directory or is relative to the current directory using the
rtems_filesystem_get_start_loc()  function.
</P>
<P>
Determine if the pathname leads to a valid directory that can be accessed
for the creation of a node.
</P>
<P>
If the pathname is a valid location to create a node, verify that a
filesystem specific mknod() function exists.
</P>
<P>
If the mknod() function exists, call the filesystem specific mknod()
function.  Pass the name, mode, device type and the location information
associated with the directory under which the node will be created.
</P>
<P><HR>
<LINK REL="Precedes" HREF="filesystem00034.html">
<LINK REV="Precedes" HREF="filesystem00032.html">
<LINK REV="Subdocument" HREF="filesystem00014.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="filesystem00032.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="filesystem00014.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="filesystem00034.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Filesystem Design Guide</CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
