<HTML>
<!-- created Dec 13 2011 from network.texi line 101 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>Networking Driver Understand the network scheduling conventions</TITLE>
<LINK REL="Precedes" HREF="bsp_howto00117.html">
<LINK REV="Precedes" HREF="bsp_howto00115.html">
<LINK REV="Subdocument" HREF="bsp_howto00113.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="bsp_howto00115.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="bsp_howto00113.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="bsp_howto00117.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>BSP and Device Driver Development Guide</CITE></P>
<H2>15.3: Understand the network scheduling conventions</H2>
<P>
When writing code for the driver transmit and receive tasks,
take care to follow the network scheduling conventions.  All tasks
which are associated with networking share various
data structures and resources.  To ensure the consistency
of these structures the tasks
execute only when they hold the network semaphore (<CODE>rtems_bsdnet_semaphore</CODE>).
The transmit and receive tasks must abide by this protocol.  Be very
careful to avoid `deadly embraces' with the other network tasks.
A number of routines are provided to make it easier for the network
driver code to conform to the network task scheduling conventions.
</P>
<UL>
<LI><CODE>void rtems_bsdnet_semaphore_release(void)</CODE>

<P>
This function releases the network semaphore.
The network driver tasks must call this function immediately before
making any blocking RTEMS request.
</P>
<LI><CODE>void rtems_bsdnet_semaphore_obtain(void)</CODE>

<P>
This function obtains the network semaphore.
If a network driver task has released the network semaphore to allow other
network-related tasks to run while the task blocks, then this function must
be called to reobtain the semaphore immediately after the return from the
blocking RTEMS request.
</P>
<LI><CODE>rtems_bsdnet_event_receive(rtems_event_set, rtems_option, rtems_interval, rtems_event_set *)</CODE>
The network driver task should call this function when it wishes to wait
for an event.  This function releases the network semaphore,
calls <CODE>rtems_event_receive</CODE> to wait for the specified event
or events and reobtains the semaphore.
The value returned is the value returned by the <CODE>rtems_event_receive</CODE>.

</UL>
<P><HR>
<LINK REL="Precedes" HREF="bsp_howto00117.html">
<LINK REV="Precedes" HREF="bsp_howto00115.html">
<LINK REV="Subdocument" HREF="bsp_howto00113.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="bsp_howto00115.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="bsp_howto00113.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="bsp_howto00117.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>BSP and Device Driver Development Guide</CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
