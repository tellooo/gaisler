<HTML>
<!-- created Dec 13 2011 from message.texi line 365 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>Message Passing Manager mq_open - Open a Message Queue</TITLE>
<LINK REL="Precedes" HREF="posix_users00330.html">
<LINK REV="Precedes" HREF="posix_users00314.html">
<LINK REV="Subdocument" HREF="posix_users00314.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="posix_users00314.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="posix_users00314.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="posix_users00330.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS POSIX API User's Guide </CITE></P>
<H3>16.4.1: mq_open - Open a Message Queue</H3>
<H3>CALLING SEQUENCE:</H3>
<DL><DT><DD>
<PRE>
#include &lt;mqueue.h&gt;

mqd_t mq_open(
  const char     *name,
  int             oflag,
  mode_t          mode,
  struct mq_attr *attr
);
</PRE>
</DL>
<H3>STATUS CODES:</H3>
<P>
<CODE>EACCES</CODE> - Either the message queue exists and the permissions
requested in oflags were denied, or the message does not exist and
permission to create one is denied.
</P>
<P>
<CODE>EEXIST</CODE> - You tried to create a message queue that already exists.
</P>
<P>
<CODE>EINVAL</CODE> - An inappropriate name was given for the message queue, or
the values of mq-maxmsg or mq_msgsize were less than 0.
</P>
<P>
<CODE>ENOENT</CODE> - The message queue does not exist, and you did not specify
to create it.
</P>
<P>
<CODE>EINTR</CODE> - The call to mq_open was interrupted by a signal.
</P>
<P>
<CODE>EMFILE</CODE> - The process has too many files or message queues open.
This is a process limit error.
</P>
<P>
<CODE>ENFILE</CODE> - The system has run out of resources to support more open
message queues. This is a system error.
</P>
<P>
<CODE>ENAMETOOLONG</CODE> - mq_name is too long.
</P>
<H3>DESCRIPTION:</H3>
<P>
The mq_open () function establishes the connection between a process and a
message queue with a message queue descriptor. If the message queue
already exists, mq_open opens it, if the message queue does not exist,
mq_open creates it. Message queues can have multiple senders and
receivers. If mq_open is successful, the function returns a message queue
descriptor. Otherwise, the function returns a -1 and sets 'errno' to
indicate the error.
</P>
<P>
The name of the message queue is used as an argument. For the best of
portability, the name of the message queue should begin with a &quot;/&quot; and no
other &quot;/&quot; should be in the name. Different systems interpret the name in
different ways.
</P>
<P>
The oflags contain information on how the message is opened if the queue
already exists. This may be O_RDONLY for read only, O_WRONLY for write
only, of O_RDWR, for read and write.
</P>
<P>
In addition, the oflags contain information needed in the creation of a
message queue. <CODE>O_NONBLOCK</CODE> - If the non-block flag is set then the
message queue is non-blocking, and requests to send and receive messages
do not block waiting for resources. If the flag is not set then the
message queue is blocking, and a request to send might have to wait for an
empty message queue. Similarly, a request to receive might have to wait
for a message to arrive on the queue. <CODE>O_CREAT</CODE> - This call specifies
that the call the mq_open is to create a new message queue. In this case
the mode and attribute arguments of the function call are utilized. The
message queue is created with a mode similar to the creation of a file,
read and write permission creator, group, and others.
</P>
<P>
The geometry of the message queue is contained in the attribute structure.
This includes mq_msgsize that dictates the maximum size of a single
message, and the mq_maxmsg that dictates the maximum number of messages
the queue can hold at one time. If a NULL is used in the mq_attr
argument, then the message queue is created with implementation defined
defaults. <CODE>O_EXCL</CODE> - is always set if O_CREAT flag is set. If the
message queue already exists, O_EXCL causes an error message to be
returned, otherwise, the new message queue fails and appends to the
existing one.
</P>
<H3>NOTES:</H3>
<P>
The mq_open () function does not add or remove messages from the queue.
When a new message queue is being created, the mq_flag field of the
attribute structure is not used.
</P>
<P><HR>
<LINK REL="Precedes" HREF="posix_users00330.html">
<LINK REV="Precedes" HREF="posix_users00314.html">
<LINK REV="Subdocument" HREF="posix_users00314.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="posix_users00314.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="posix_users00314.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="posix_users00330.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS POSIX API User's Guide </CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
