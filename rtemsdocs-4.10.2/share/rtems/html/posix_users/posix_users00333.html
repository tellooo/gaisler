<HTML>
<!-- created Dec 13 2011 from message.texi line 605 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>Message Passing Manager mq_receive - Receive a Message from a Message Queue</TITLE>
<LINK REL="Precedes" HREF="posix_users00334.html">
<LINK REV="Precedes" HREF="posix_users00332.html">
<LINK REV="Subdocument" HREF="posix_users00314.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="posix_users00332.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="posix_users00314.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="posix_users00334.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS POSIX API User's Guide </CITE></P>
<H3>16.4.5: mq_receive - Receive a Message from a Message Queue</H3>
<H3>CALLING SEQUENCE:</H3>
<DL><DT><DD>
<PRE>
#include &lt;mqueue.h&gt;

size_t mq_receive(
  mqd_t         mqdes,
  char         *msg_ptr,
  size_t        msg_len,
  unsigned int *msg_prio
);
</PRE>
</DL>
<H3>STATUS CODES:</H3>
<P>
<CODE>EBADF</CODE> - The descriptor does not represent a valid message queue, or the queue was opened for write only O_WRONLY
<CODE>EMSGSIZE</CODE> - The msg_len is less than the mq_msgsize attribute of the message queue
<CODE>EAGAIN</CODE> - The message queue is non-blocking, and the queue is empty
<CODE>EINTR</CODE> - The message queue is blocking. While the process was waiting for a message to arrive on the queue, a signal arrived that interrupted the wait.
</P>
<H3>DESCRIPTION:</H3>
<P>
The mq_receive function is used to receive the oldest of the highest
priority message(s) from the message queue specified by mqdes. The
messages are received in FIFO order within the priorities. The received
message's priority is stored in the location referenced by the msg_prio.
If the msg_prio is a NULL, the priority is discarded. The message is
removed and stored in an area pointed to by msg_ptr whose length is of
msg_len. The msg_len must be at least equal to the mq_msgsize attribute
of the message queue.
</P>
<P>
The blocking behavior of the message queue is set by O_NONBLOCK at mq_open
or by setting O_NONBLOCK in mq_flags in a call to mq_setattr. If this is
a blocking queue, the process blocks and waits on an empty queue. If this
a non-blocking queue, the process does not block.
</P>
<P>
Upon successful completion, mq_receive returns the length of the selected
message in bytes and the message is removed from the queue. Otherwise, no
message is removed from the queue, the function returns a value of -1, and
sets errno to indicate the error.
</P>
<H3>NOTES:</H3>
<P>
If the size of the buffer in bytes, specified by the msg_len argument, is
less than the mq_msgsize attribute of the message queue, the function
fails and returns an error
</P>
<P><HR>
<LINK REL="Precedes" HREF="posix_users00334.html">
<LINK REV="Precedes" HREF="posix_users00332.html">
<LINK REV="Subdocument" HREF="posix_users00314.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="posix_users00332.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="posix_users00314.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="posix_users00334.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS POSIX API User's Guide </CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
