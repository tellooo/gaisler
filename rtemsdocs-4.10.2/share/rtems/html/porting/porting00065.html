<HTML>
<!-- created Dec 13 2011 from prioritybitmap.texi line 24 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>Priority Bitmap Manipulation Introduction</TITLE>
<LINK REL="Precedes" HREF="porting00066.html">
<LINK REV="Precedes" HREF="porting00064.html">
<LINK REV="Subdocument" HREF="porting00064.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="porting00064.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="porting00064.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="porting00066.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Porting Guide</CITE></P>
<H2>8.1: Introduction</H2>
<P>
The RTEMS chain of ready tasks is implemented as an array of FIFOs with
each priority having its own FIFO.  This makes it very efficient to
determine the first and last ready task at each priority.  In addition,
blocking a task only requires appending the task to the end of the FIFO
for its priority rather than a lengthy search down a single chain of all
ready tasks.  This works extremely well except for one problem.  When the
currently executing task blocks, there may be no easy way to determine
what is the next most important ready task.  If the blocking task was the
only ready task at its priority, then RTEMS must search all of the FIFOs
in the ready chain to determine the highest priority with a ready task.
</P>
<P>
RTEMS uses a bitmap array to efficiently solve this problem.  The state of
each bit in the priority map bit array indicates whether or not there is a
ready task at that priority.  The bit array can be efficiently searched to
determine the highest priority ready task.  This family of data type and
routines is used to maintain and search the bit map array.
</P>
<P>
When manipulating the bitmap array, RTEMS internally divides the
8 bits of the task priority into &quot;major&quot; and &quot;minor&quot; components.
The most significant 4 bits are the major component, while the least
significant are the minor component.  The major component of a priority
value is used to determine which 16-bit wide entry in the
<CODE>_Priority_Bit_map</CODE> array is associated with this priority.
Each element in the <CODE>_Priority_Bit_map</CODE> array has a bit
in the <CODE>_Priority_Major_bit_map</CODE> associated with it.
That bit is cleared when all of the bits in a particular
<CODE>_Priority_Bit_map</CODE> array entry are zero.
</P>
<P>
The minor component of a priority is used to determine
specifically which bit in <CODE>_Priority_Bit_map[major]</CODE>
indicates whether or not there is a ready to execute task
at the priority.
</P>
<P><HR>
<LINK REL="Precedes" HREF="porting00066.html">
<LINK REV="Precedes" HREF="porting00064.html">
<LINK REV="Subdocument" HREF="porting00064.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="porting00064.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="porting00064.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="porting00066.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Porting Guide</CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
