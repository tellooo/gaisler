<HTML>
<!-- created Dec 13 2011 from ../user/intr.texi line 57 via texi2www -->
<BODY BGCOLOR="FFFFFF">
<A HREF="http://www.rtems.com" target="Text Frame">
  <IMG align=right BORDER=0 SRC="../images/rtems_logo.jpg" ALT="RTEMS Logo"> </A>
<H1>RTEMS 4.10.2 On-Line Library</H1>
<HR>
<HEAD>
<TITLE>Interrupt Manager Processing an Interrupt</TITLE>
<LINK REL="Precedes" HREF="ada_user00098.html">
<LINK REV="Precedes" HREF="ada_user00094.html">
<LINK REV="Subdocument" HREF="ada_user00094.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="ada_user00094.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="ada_user00094.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="ada_user00098.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Ada User's Guide</CITE></P>
<H3>6.2.1: Processing an Interrupt</H3>
<P>
The interrupt manager allows the application to
connect a function to a hardware interrupt vector.  When an
interrupt occurs, the processor will automatically vector to
RTEMS.  RTEMS saves and restores all registers which are not
preserved by the normal Ada calling convention
for the target
processor and invokes the user's ISR.  The user's ISR is
responsible for processing the interrupt, clearing the interrupt
if necessary, and device specific manipulation.
</P>
<P>
The <CODE>rtems.interrupt_catch</CODE>
directive connects a procedure to
an interrupt vector.  The vector number is managed using
the <CODE>rtems.vector_number</CODE> data type.
</P>
<P>
The interrupt service routine is assumed
to abide by these conventions and have a prototype similar to
the following:
</P>
<DL><DT><DD>
<PRE>
NOT SUPPORTED FROM Ada BINDING
</PRE>
</DL>
<P>
The vector number argument is provided by RTEMS to
allow the application to identify the interrupt source.  This
could be used to allow a single routine to service interrupts
from multiple instances of the same device.  For example, a
single routine could service interrupts from multiple serial
ports and use the vector number to identify which port requires
servicing.
</P>
<P>
To minimize the masking of lower or equal priority
level interrupts, the ISR should perform the minimum actions
required to service the interrupt.  Other non-essential actions
should be handled by application tasks.  Once the user's ISR has
completed, it returns control to the RTEMS interrupt manager
which will perform task dispatching and restore the registers
saved before the ISR was invoked.
</P>
<P>
The RTEMS interrupt manager guarantees that proper
task scheduling and dispatching are performed at the conclusion
of an ISR.  A system call made by the ISR may have readied a
task of higher priority than the interrupted task.  Therefore,
when the ISR completes, the postponed dispatch processing must
be performed.  No dispatch processing is performed as part of
directives which have been invoked by an ISR.
</P>
<P>
Applications must adhere to the following rule if
proper task scheduling and dispatching is to be performed:
</P>
<UL>
<LI><STRONG>The interrupt manager must be used for all ISRs which may be interrupted by the highest priority ISR which invokes an RTEMS directive.</STRONG>

</UL>
<P>
Consider a processor which allows a numerically low
interrupt level to interrupt a numerically greater interrupt
level.  In this example, if an RTEMS directive is used in a
level 4 ISR, then all ISRs which execute at levels 0 through 4
must use the interrupt manager.
</P>
<P>
Interrupts are nested whenever an interrupt occurs
during the execution of another ISR.  RTEMS supports efficient
interrupt nesting by allowing the nested ISRs to terminate
without performing any dispatch processing.  Only when the
outermost ISR terminates will the postponed dispatching occur.
</P>
<P><HR>
<LINK REL="Precedes" HREF="ada_user00098.html">
<LINK REV="Precedes" HREF="ada_user00094.html">
<LINK REV="Subdocument" HREF="ada_user00094.html">
<LINK REV="Library" HREF="../index.html">
</HEAD><BODY><P>
<A HREF="ada_user00094.html"><IMG ALIGN=MIDDLE SRC="../images/prev-arrow.gif" ALT="PREV"></A>
<A HREF="ada_user00094.html"> <IMG ALIGN=MIDDLE SRC="../images/up-arrow.gif" ALT="UP"></A>
<A HREF="ada_user00098.html"><IMG ALIGN=MIDDLE SRC="../images/next-arrow.gif" ALT="NEXT"></A>
<A HREF="../index.html"> <IMG ALIGN=MIDDLE SRC="../images/dir-arrow.gif" ALT="Bookshelf"></A>
<CITE>RTEMS Ada User's Guide</CITE></P>
<P>Copyright &copy; 1988-2008 <A HREF="http://www.oarcorp.com" target="Text Frame">OAR Corporation</A>
</BODY></HTML>
