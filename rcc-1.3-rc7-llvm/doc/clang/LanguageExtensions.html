

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Clang Language Extensions &mdash; Clang 8 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="Clang 8 documentation" href="index.html" />
    <link rel="next" title="Objective-C Literals" href="ObjectiveCLiterals.html" />
    <link rel="prev" title="Assembling a Complete Toolchain" href="Toolchain.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Clang 8 documentation</span></a></h1>
        <h2 class="heading"><span>Clang Language Extensions</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="Toolchain.html">Assembling a Complete Toolchain</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="ObjectiveCLiterals.html">Objective-C Literals</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="clang-language-extensions">
<h1>Clang Language Extensions<a class="headerlink" href="#clang-language-extensions" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a></li>
<li><a class="reference internal" href="#feature-checking-macros" id="id2">Feature Checking Macros</a></li>
<li><a class="reference internal" href="#include-file-checking-macros" id="id3">Include File Checking Macros</a></li>
<li><a class="reference internal" href="#builtin-macros" id="id4">Builtin Macros</a></li>
<li><a class="reference internal" href="#vectors-and-extended-vectors" id="id5">Vectors and Extended Vectors</a></li>
<li><a class="reference internal" href="#half-precision-floating-point" id="id6">Half-Precision Floating Point</a></li>
<li><a class="reference internal" href="#messages-on-deprecated-and-unavailable-attributes" id="id7">Messages on <tt class="docutils literal"><span class="pre">deprecated</span></tt> and <tt class="docutils literal"><span class="pre">unavailable</span></tt> Attributes</a></li>
<li><a class="reference internal" href="#attributes-on-enumerators" id="id8">Attributes on Enumerators</a></li>
<li><a class="reference internal" href="#user-specified-system-frameworks" id="id9">&#8216;User-Specified&#8217; System Frameworks</a></li>
<li><a class="reference internal" href="#checks-for-standard-language-features" id="id10">Checks for Standard Language Features</a></li>
<li><a class="reference internal" href="#checks-for-type-trait-primitives" id="id11">Checks for Type Trait Primitives</a></li>
<li><a class="reference internal" href="#blocks" id="id12">Blocks</a></li>
<li><a class="reference internal" href="#objective-c-features" id="id13">Objective-C Features</a></li>
<li><a class="reference internal" href="#initializer-lists-for-complex-numbers-in-c" id="id14">Initializer lists for complex numbers in C</a></li>
<li><a class="reference internal" href="#builtin-functions" id="id15">Builtin Functions</a></li>
<li><a class="reference internal" href="#non-standard-c-11-attributes" id="id16">Non-standard C++11 Attributes</a></li>
<li><a class="reference internal" href="#target-specific-extensions" id="id17">Target-Specific Extensions</a></li>
<li><a class="reference internal" href="#extensions-for-static-analysis" id="id18">Extensions for Static Analysis</a></li>
<li><a class="reference internal" href="#extensions-for-dynamic-analysis" id="id19">Extensions for Dynamic Analysis</a></li>
<li><a class="reference internal" href="#extensions-for-selectively-disabling-optimization" id="id20">Extensions for selectively disabling optimization</a></li>
<li><a class="reference internal" href="#extensions-for-loop-hint-optimizations" id="id21">Extensions for loop hint optimizations</a></li>
<li><a class="reference internal" href="#extensions-to-specify-floating-point-flags" id="id22">Extensions to specify floating-point flags</a></li>
<li><a class="reference internal" href="#specifying-an-attribute-for-multiple-declarations-pragma-clang-attribute" id="id23">Specifying an attribute for multiple declarations (#pragma clang attribute)</a></li>
<li><a class="reference internal" href="#specifying-section-names-for-global-objects-pragma-clang-section" id="id24">Specifying section names for global objects (#pragma clang section)</a></li>
<li><a class="reference internal" href="#specifying-linker-options-on-elf-targets" id="id25">Specifying Linker Options on ELF Targets</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document describes the language extensions provided by Clang.  In addition
to the language extensions listed here, Clang aims to support a broad range of
GCC extensions.  Please see the <a class="reference external" href="http://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html">GCC manual</a> for more information on
these extensions.</p>
</div>
<div class="section" id="feature-checking-macros">
<span id="langext-feature-check"></span><h2><a class="toc-backref" href="#id2">Feature Checking Macros</a><a class="headerlink" href="#feature-checking-macros" title="Permalink to this headline">¶</a></h2>
<p>Language extensions can be very useful, but only if you know you can depend on
them.  In order to allow fine-grain features checks, we support three builtin
function-like macros.  This allows you to directly test for a feature in your
code without having to resort to something like autoconf or fragile &#8220;compiler
version checks&#8221;.</p>
<div class="section" id="has-builtin">
<h3><tt class="docutils literal"><span class="pre">__has_builtin</span></tt><a class="headerlink" href="#has-builtin" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single identifier argument that is the name of
a builtin function.  It evaluates to 1 if the builtin is supported or 0 if not.
It can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#ifndef __has_builtin         </span><span class="c1">// Optional of course.</span>
  <span class="cp">#define __has_builtin(x) 0  </span><span class="c1">// Compatibility with non-clang compilers.</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_builtin(__builtin_trap)</span>
  <span class="n">__builtin_trap</span><span class="p">();</span>
<span class="cp">#else</span>
  <span class="n">abort</span><span class="p">();</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
</div>
<div class="section" id="has-feature-and-has-extension">
<span id="langext-has-feature-has-extension"></span><h3><tt class="docutils literal"><span class="pre">__has_feature</span></tt> and <tt class="docutils literal"><span class="pre">__has_extension</span></tt><a class="headerlink" href="#has-feature-and-has-extension" title="Permalink to this headline">¶</a></h3>
<p>These function-like macros take a single identifier argument that is the name
of a feature.  <tt class="docutils literal"><span class="pre">__has_feature</span></tt> evaluates to 1 if the feature is both
supported by Clang and standardized in the current language standard or 0 if
not (but see <a class="reference internal" href="#langext-has-feature-back-compat"><em>below</em></a>), while
<tt class="docutils literal"><span class="pre">__has_extension</span></tt> evaluates to 1 if the feature is supported by Clang in the
current language (either as a language extension or a standard language
feature) or 0 if not.  They can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#ifndef __has_feature         </span><span class="c1">// Optional of course.</span>
  <span class="cp">#define __has_feature(x) 0  </span><span class="c1">// Compatibility with non-clang compilers.</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef __has_extension</span>
  <span class="cp">#define __has_extension __has_feature </span><span class="c1">// Compatibility with pre-3.0 compilers.</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_feature(cxx_rvalue_references)</span>
<span class="c1">// This code will only be compiled with the -std=c++11 and -std=gnu++11</span>
<span class="c1">// options, because rvalue references are only standardized in C++11.</span>
<span class="cp">#endif</span>

<span class="cp">#if __has_extension(cxx_rvalue_references)</span>
<span class="c1">// This code will be compiled with the -std=c++11, -std=gnu++11, -std=c++98</span>
<span class="c1">// and -std=gnu++98 options, because rvalue references are supported as a</span>
<span class="c1">// language extension in C++98.</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p id="langext-has-feature-back-compat">For backward compatibility, <tt class="docutils literal"><span class="pre">__has_feature</span></tt> can also be used to test
for support for non-standardized features, i.e. features not prefixed <tt class="docutils literal"><span class="pre">c_</span></tt>,
<tt class="docutils literal"><span class="pre">cxx_</span></tt> or <tt class="docutils literal"><span class="pre">objc_</span></tt>.</p>
<p>Another use of <tt class="docutils literal"><span class="pre">__has_feature</span></tt> is to check for compiler features not related
to the language standard, such as e.g. <a class="reference internal" href="AddressSanitizer.html"><em>AddressSanitizer</em></a>.</p>
<p>If the <tt class="docutils literal"><span class="pre">-pedantic-errors</span></tt> option is given, <tt class="docutils literal"><span class="pre">__has_extension</span></tt> is equivalent
to <tt class="docutils literal"><span class="pre">__has_feature</span></tt>.</p>
<p>The feature tag is described along with the language feature below.</p>
<p>The feature name or extension name can also be specified with a preceding and
following <tt class="docutils literal"><span class="pre">__</span></tt> (double underscore) to avoid interference from a macro with
the same name.  For instance, <tt class="docutils literal"><span class="pre">__cxx_rvalue_references__</span></tt> can be used instead
of <tt class="docutils literal"><span class="pre">cxx_rvalue_references</span></tt>.</p>
</div>
<div class="section" id="has-cpp-attribute">
<h3><tt class="docutils literal"><span class="pre">__has_cpp_attribute</span></tt><a class="headerlink" href="#has-cpp-attribute" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro is available in C++2a by default, and is provided as an
extension in earlier language standards. It takes a single argument that is the
name of a double-square-bracket-style attribute. The argument can either be a
single identifier or a scoped identifier. If the attribute is supported, a
nonzero value is returned. If the attribute is a standards-based attribute, this
macro returns a nonzero value based on the year and month in which the attribute
was voted into the working draft. See <a class="reference external" href="https://isocpp.org/std/standing-documents/sd-6-sg10-feature-test-recommendations">WG21 SD-6</a>
for the list of values returned for standards-based attributes. If the attribute
is not supported by the current compliation target, this macro evaluates to 0.
It can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#ifndef __has_cpp_attribute         </span><span class="c1">// For backwards compatibility</span>
  <span class="cp">#define __has_cpp_attribute(x) 0</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_cpp_attribute(clang::fallthrough)</span>
<span class="cp">#define FALLTHROUGH [[clang::fallthrough]]</span>
<span class="cp">#else</span>
<span class="cp">#define FALLTHROUGH</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
<p>The attribute scope tokens <tt class="docutils literal"><span class="pre">clang</span></tt> and <tt class="docutils literal"><span class="pre">_Clang</span></tt> are interchangeable, as are
the attribute scope tokens <tt class="docutils literal"><span class="pre">gnu</span></tt> and <tt class="docutils literal"><span class="pre">__gnu__</span></tt>. Attribute tokens in either
of these namespaces can be specified with a preceding and following <tt class="docutils literal"><span class="pre">__</span></tt>
(double underscore) to avoid interference from a macro with the same name. For
instance, <tt class="docutils literal"><span class="pre">gnu::__const__</span></tt> can be used instead of <tt class="docutils literal"><span class="pre">gnu::const</span></tt>.</p>
</div>
<div class="section" id="has-c-attribute">
<h3><tt class="docutils literal"><span class="pre">__has_c_attribute</span></tt><a class="headerlink" href="#has-c-attribute" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single argument that is the name of an
attribute exposed with the double square-bracket syntax in C mode. The argument
can either be a single identifier or a scoped identifier. If the attribute is
supported, a nonzero value is returned. If the attribute is not supported by the
current compilation target, this macro evaluates to 0. It can be used like this:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#ifndef __has_c_attribute         </span><span class="c1">// Optional of course.</span>
  <span class="cp">#define __has_c_attribute(x) 0  </span><span class="c1">// Compatibility with non-clang compilers.</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_c_attribute(fallthrough)</span>
  <span class="cp">#define FALLTHROUGH [[fallthrough]]</span>
<span class="cp">#else</span>
  <span class="cp">#define FALLTHROUGH</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
<p>The attribute scope tokens <tt class="docutils literal"><span class="pre">clang</span></tt> and <tt class="docutils literal"><span class="pre">_Clang</span></tt> are interchangeable, as are
the attribute scope tokens <tt class="docutils literal"><span class="pre">gnu</span></tt> and <tt class="docutils literal"><span class="pre">__gnu__</span></tt>. Attribute tokens in either
of these namespaces can be specified with a preceding and following <tt class="docutils literal"><span class="pre">__</span></tt>
(double underscore) to avoid interference from a macro with the same name. For
instance, <tt class="docutils literal"><span class="pre">gnu::__const__</span></tt> can be used instead of <tt class="docutils literal"><span class="pre">gnu::const</span></tt>.</p>
</div>
<div class="section" id="has-attribute">
<h3><tt class="docutils literal"><span class="pre">__has_attribute</span></tt><a class="headerlink" href="#has-attribute" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single identifier argument that is the name of
a GNU-style attribute.  It evaluates to 1 if the attribute is supported by the
current compilation target, or 0 if not.  It can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#ifndef __has_attribute         </span><span class="c1">// Optional of course.</span>
  <span class="cp">#define __has_attribute(x) 0  </span><span class="c1">// Compatibility with non-clang compilers.</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_attribute(always_inline)</span>
<span class="cp">#define ALWAYS_INLINE __attribute__((always_inline))</span>
<span class="cp">#else</span>
<span class="cp">#define ALWAYS_INLINE</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
<p>The attribute name can also be specified with a preceding and following <tt class="docutils literal"><span class="pre">__</span></tt>
(double underscore) to avoid interference from a macro with the same name.  For
instance, <tt class="docutils literal"><span class="pre">__always_inline__</span></tt> can be used instead of <tt class="docutils literal"><span class="pre">always_inline</span></tt>.</p>
</div>
<div class="section" id="has-declspec-attribute">
<h3><tt class="docutils literal"><span class="pre">__has_declspec_attribute</span></tt><a class="headerlink" href="#has-declspec-attribute" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single identifier argument that is the name of
an attribute implemented as a Microsoft-style <tt class="docutils literal"><span class="pre">__declspec</span></tt> attribute.  It
evaluates to 1 if the attribute is supported by the current compilation target,
or 0 if not.  It can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#ifndef __has_declspec_attribute         </span><span class="c1">// Optional of course.</span>
  <span class="cp">#define __has_declspec_attribute(x) 0  </span><span class="c1">// Compatibility with non-clang compilers.</span>
<span class="cp">#endif</span>

<span class="p">...</span>
<span class="cp">#if __has_declspec_attribute(dllexport)</span>
<span class="cp">#define DLLEXPORT __declspec(dllexport)</span>
<span class="cp">#else</span>
<span class="cp">#define DLLEXPORT</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
<p>The attribute name can also be specified with a preceding and following <tt class="docutils literal"><span class="pre">__</span></tt>
(double underscore) to avoid interference from a macro with the same name.  For
instance, <tt class="docutils literal"><span class="pre">__dllexport__</span></tt> can be used instead of <tt class="docutils literal"><span class="pre">dllexport</span></tt>.</p>
</div>
<div class="section" id="is-identifier">
<h3><tt class="docutils literal"><span class="pre">__is_identifier</span></tt><a class="headerlink" href="#is-identifier" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single identifier argument that might be either
a reserved word or a regular identifier. It evaluates to 1 if the argument is just
a regular identifier and not a reserved word, in the sense that it can then be
used as the name of a user-defined function or variable. Otherwise it evaluates
to 0.  It can be used like this:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="p">...</span>
<span class="cp">#ifdef __is_identifier          </span><span class="c1">// Compatibility with non-clang compilers.</span>
  <span class="cp">#if __is_identifier(__wchar_t)</span>
    <span class="k">typedef</span> <span class="kt">wchar_t</span> <span class="kr">__wchar_t</span><span class="p">;</span>
  <span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="kr">__wchar_t</span> <span class="n">WideCharacter</span><span class="p">;</span>
<span class="p">...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="include-file-checking-macros">
<h2><a class="toc-backref" href="#id3">Include File Checking Macros</a><a class="headerlink" href="#include-file-checking-macros" title="Permalink to this headline">¶</a></h2>
<p>Not all developments systems have the same include files.  The
<a class="reference internal" href="#langext-has-include"><em>__has_include</em></a> and <a class="reference internal" href="#langext-has-include-next"><em>__has_include_next</em></a> macros allow
you to check for the existence of an include file before doing a possibly
failing <tt class="docutils literal"><span class="pre">#include</span></tt> directive.  Include file checking macros must be used
as expressions in <tt class="docutils literal"><span class="pre">#if</span></tt> or <tt class="docutils literal"><span class="pre">#elif</span></tt> preprocessing directives.</p>
<div class="section" id="has-include">
<span id="langext-has-include"></span><h3><tt class="docutils literal"><span class="pre">__has_include</span></tt><a class="headerlink" href="#has-include" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single file name string argument that is the
name of an include file.  It evaluates to 1 if the file can be found using the
include paths, or 0 otherwise:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// Note the two possible file name string formats.</span>
<span class="cp">#if __has_include(&quot;myinclude.h&quot;) &amp;&amp; __has_include(&lt;stdint.h&gt;)</span>
<span class="cp"># include &quot;myinclude.h&quot;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>To test for this feature, use <tt class="docutils literal"><span class="pre">#if</span> <span class="pre">defined(__has_include)</span></tt>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// To avoid problem with non-clang compilers not having this macro.</span>
<span class="cp">#if defined(__has_include)</span>
<span class="cp">#if __has_include(&quot;myinclude.h&quot;)</span>
<span class="cp"># include &quot;myinclude.h&quot;</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="section" id="has-include-next">
<span id="langext-has-include-next"></span><h3><tt class="docutils literal"><span class="pre">__has_include_next</span></tt><a class="headerlink" href="#has-include-next" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a single file name string argument that is the
name of an include file.  It is like <tt class="docutils literal"><span class="pre">__has_include</span></tt> except that it looks for
the second instance of the given file found in the include paths.  It evaluates
to 1 if the second instance of the file can be found using the include paths,
or 0 otherwise:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// Note the two possible file name string formats.</span>
<span class="cp">#if __has_include_next(&quot;myinclude.h&quot;) &amp;&amp; __has_include_next(&lt;stdint.h&gt;)</span>
<span class="cp"># include_next &quot;myinclude.h&quot;</span>
<span class="cp">#endif</span>

<span class="c1">// To avoid problem with non-clang compilers not having this macro.</span>
<span class="cp">#if defined(__has_include_next)</span>
<span class="cp">#if __has_include_next(&quot;myinclude.h&quot;)</span>
<span class="cp"># include_next &quot;myinclude.h&quot;</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>Note that <tt class="docutils literal"><span class="pre">__has_include_next</span></tt>, like the GNU extension <tt class="docutils literal"><span class="pre">#include_next</span></tt>
directive, is intended for use in headers only, and will issue a warning if
used in the top-level compilation file.  A warning will also be issued if an
absolute path is used in the file argument.</p>
</div>
<div class="section" id="has-warning">
<h3><tt class="docutils literal"><span class="pre">__has_warning</span></tt><a class="headerlink" href="#has-warning" title="Permalink to this headline">¶</a></h3>
<p>This function-like macro takes a string literal that represents a command line
option for a warning and returns true if that is a valid warning option.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#if __has_warning(&quot;-Wformat&quot;)</span>
<span class="p">...</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="builtin-macros">
<h2><a class="toc-backref" href="#id4">Builtin Macros</a><a class="headerlink" href="#builtin-macros" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">__BASE_FILE__</span></tt></dt>
<dd>Defined to a string that contains the name of the main input file passed to
Clang.</dd>
<dt><tt class="docutils literal"><span class="pre">__COUNTER__</span></tt></dt>
<dd>Defined to an integer value that starts at zero and is incremented each time
the <tt class="docutils literal"><span class="pre">__COUNTER__</span></tt> macro is expanded.</dd>
<dt><tt class="docutils literal"><span class="pre">__INCLUDE_LEVEL__</span></tt></dt>
<dd>Defined to an integral value that is the include depth of the file currently
being translated.  For the main file, this value is zero.</dd>
<dt><tt class="docutils literal"><span class="pre">__TIMESTAMP__</span></tt></dt>
<dd>Defined to the date and time of the last modification of the current source
file.</dd>
<dt><tt class="docutils literal"><span class="pre">__clang__</span></tt></dt>
<dd>Defined when compiling with Clang</dd>
<dt><tt class="docutils literal"><span class="pre">__clang_major__</span></tt></dt>
<dd>Defined to the major marketing version number of Clang (e.g., the 2 in
2.0.1).  Note that marketing version numbers should not be used to check for
language features, as different vendors use different numbering schemes.
Instead, use the <a class="reference internal" href="#langext-feature-check"><em>Feature Checking Macros</em></a>.</dd>
<dt><tt class="docutils literal"><span class="pre">__clang_minor__</span></tt></dt>
<dd>Defined to the minor version number of Clang (e.g., the 0 in 2.0.1).  Note
that marketing version numbers should not be used to check for language
features, as different vendors use different numbering schemes.  Instead, use
the <a class="reference internal" href="#langext-feature-check"><em>Feature Checking Macros</em></a>.</dd>
<dt><tt class="docutils literal"><span class="pre">__clang_patchlevel__</span></tt></dt>
<dd>Defined to the marketing patch level of Clang (e.g., the 1 in 2.0.1).</dd>
<dt><tt class="docutils literal"><span class="pre">__clang_version__</span></tt></dt>
<dd>Defined to a string that captures the Clang marketing version, including the
Subversion tag or revision number, e.g., &#8220;<tt class="docutils literal"><span class="pre">1.5</span> <span class="pre">(trunk</span> <span class="pre">102332)</span></tt>&#8221;.</dd>
</dl>
</div>
<div class="section" id="vectors-and-extended-vectors">
<span id="langext-vectors"></span><h2><a class="toc-backref" href="#id5">Vectors and Extended Vectors</a><a class="headerlink" href="#vectors-and-extended-vectors" title="Permalink to this headline">¶</a></h2>
<p>Supports the GCC, OpenCL, AltiVec and NEON vector extensions.</p>
<p>OpenCL vector types are created using <tt class="docutils literal"><span class="pre">ext_vector_type</span></tt> attribute.  It
support for <tt class="docutils literal"><span class="pre">V.xyzw</span></tt> syntax and other tidbits as seen in OpenCL.  An example
is:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="kt">float</span> <span class="n">float4</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ext_vector_type</span><span class="p">(</span><span class="mi">4</span><span class="p">)));</span>
<span class="k">typedef</span> <span class="kt">float</span> <span class="n">float2</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ext_vector_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span>

<span class="n">float4</span> <span class="n">foo</span><span class="p">(</span><span class="n">float2</span> <span class="n">a</span><span class="p">,</span> <span class="n">float2</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">float4</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">c</span><span class="p">.</span><span class="n">xz</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">c</span><span class="p">.</span><span class="n">yw</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_extension(attribute_ext_vector_type)</span></tt>.</p>
<p>Giving <tt class="docutils literal"><span class="pre">-maltivec</span></tt> option to clang enables support for AltiVec vector syntax
and functions.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">vector</span> <span class="kt">float</span> <span class="n">foo</span><span class="p">(</span><span class="n">vector</span> <span class="kt">int</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">vector</span> <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">vec_add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">float</span><span class="p">)</span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>NEON vector types are created using <tt class="docutils literal"><span class="pre">neon_vector_type</span></tt> and
<tt class="docutils literal"><span class="pre">neon_polyvector_type</span></tt> attributes.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">neon_vector_type</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span> <span class="n">int8_t</span> <span class="n">int8x8_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">neon_polyvector_type</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span> <span class="n">poly8_t</span> <span class="n">poly8x16_t</span><span class="p">;</span>

<span class="n">int8x8_t</span> <span class="n">foo</span><span class="p">(</span><span class="n">int8x8_t</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">int8x8_t</span> <span class="n">v</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">v</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="vector-literals">
<h3>Vector Literals<a class="headerlink" href="#vector-literals" title="Permalink to this headline">¶</a></h3>
<p>Vector literals can be used to create vectors from a set of scalars, or
vectors.  Either parentheses or braces form can be used.  In the parentheses
form the number of literal values specified must be one, i.e. referring to a
scalar value, or must match the size of the vector type being created.  If a
single scalar literal value is specified, the scalar literal value will be
replicated to all the components of the vector type.  In the brackets form any
number of literals can be specified.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="kt">int</span> <span class="n">v4si</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">__vector_size__</span><span class="p">(</span><span class="mi">16</span><span class="p">)));</span>
<span class="k">typedef</span> <span class="kt">float</span> <span class="n">float4</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ext_vector_type</span><span class="p">(</span><span class="mi">4</span><span class="p">)));</span>
<span class="k">typedef</span> <span class="kt">float</span> <span class="n">float2</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ext_vector_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span>

<span class="n">v4si</span> <span class="n">vsi</span> <span class="o">=</span> <span class="p">(</span><span class="n">v4si</span><span class="p">){</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">};</span>
<span class="n">float4</span> <span class="n">vf</span> <span class="o">=</span> <span class="p">(</span><span class="n">float4</span><span class="p">)(</span><span class="mf">1.0f</span><span class="p">,</span> <span class="mf">2.0f</span><span class="p">,</span> <span class="mf">3.0f</span><span class="p">,</span> <span class="mf">4.0f</span><span class="p">);</span>
<span class="n">vector</span> <span class="kt">int</span> <span class="n">vi1</span> <span class="o">=</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">int</span><span class="p">)(</span><span class="mi">1</span><span class="p">);</span>    <span class="c1">// vi1 will be (1, 1, 1, 1).</span>
<span class="n">vector</span> <span class="kt">int</span> <span class="n">vi2</span> <span class="o">=</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">int</span><span class="p">){</span><span class="mi">1</span><span class="p">};</span>    <span class="c1">// vi2 will be (1, 0, 0, 0).</span>
<span class="n">vector</span> <span class="kt">int</span> <span class="n">vi3</span> <span class="o">=</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">int</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// error</span>
<span class="n">vector</span> <span class="kt">int</span> <span class="n">vi4</span> <span class="o">=</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">int</span><span class="p">){</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span> <span class="c1">// vi4 will be (1, 2, 0, 0).</span>
<span class="n">vector</span> <span class="kt">int</span> <span class="n">vi5</span> <span class="o">=</span> <span class="p">(</span><span class="n">vector</span> <span class="kt">int</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">float4</span> <span class="n">vf</span> <span class="o">=</span> <span class="p">(</span><span class="n">float4</span><span class="p">)((</span><span class="n">float2</span><span class="p">)(</span><span class="mf">1.0f</span><span class="p">,</span> <span class="mf">2.0f</span><span class="p">),</span> <span class="p">(</span><span class="n">float2</span><span class="p">)(</span><span class="mf">3.0f</span><span class="p">,</span> <span class="mf">4.0f</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="vector-operations">
<h3>Vector Operations<a class="headerlink" href="#vector-operations" title="Permalink to this headline">¶</a></h3>
<p>The table below shows the support for each operation by vector extension.  A
dash indicates that an operation is not accepted according to a corresponding
specification.</p>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">OpenCL</th>
<th class="head">AltiVec</th>
<th class="head">GCC</th>
<th class="head">NEON</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>[]</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td>unary operators +, &#8211;</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td>++, &#8211; &#8211;</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td>+,&#8211;,*,/,%</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td>bitwise operators &amp;,|,^,~</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td>&gt;&gt;,&lt;&lt;</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td>!, &amp;&amp;, ||</td>
<td>yes</td>
<td>&#8211;</td>
<td>&#8211;</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td>==, !=, &gt;, &lt;, &gt;=, &lt;=</td>
<td>yes</td>
<td>yes</td>
<td>&#8211;</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td>=</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>:?</td>
<td>yes</td>
<td>&#8211;</td>
<td>&#8211;</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td>sizeof</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>C-style cast</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>reinterpret_cast</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>static_cast</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>const_cast</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="#langext-builtin-shufflevector"><em>__builtin_shufflevector</em></a>, <a class="reference internal" href="#langext-builtin-convertvector"><em>__builtin_convertvector</em></a>.</p>
</div>
</div>
<div class="section" id="half-precision-floating-point">
<h2><a class="toc-backref" href="#id6">Half-Precision Floating Point</a><a class="headerlink" href="#half-precision-floating-point" title="Permalink to this headline">¶</a></h2>
<p>Clang supports two half-precision (16-bit) floating point types: <tt class="docutils literal"><span class="pre">__fp16</span></tt> and
<tt class="docutils literal"><span class="pre">_Float16</span></tt>.  These types are supported in all language modes.</p>
<p><tt class="docutils literal"><span class="pre">__fp16</span></tt> is supported on every target, as it is purely a storage format; see below.
<tt class="docutils literal"><span class="pre">_Float16</span></tt> is currently only supported on the following targets, with further
targets pending ABI standardization:
- 32-bit ARM
- 64-bit ARM (AArch64)
- SPIR
<tt class="docutils literal"><span class="pre">_Float16</span></tt> will be supported on more targets as they define ABIs for it.</p>
<p><tt class="docutils literal"><span class="pre">__fp16</span></tt> is a storage and interchange format only.  This means that values of
<tt class="docutils literal"><span class="pre">__fp16</span></tt> are immediately promoted to (at least) <tt class="docutils literal"><span class="pre">float</span></tt> when used in arithmetic
operations, so that e.g. the result of adding two <tt class="docutils literal"><span class="pre">__fp16</span></tt> values has type <tt class="docutils literal"><span class="pre">float</span></tt>.
The behavior of <tt class="docutils literal"><span class="pre">__fp16</span></tt> is specified by the ARM C Language Extensions (<a class="reference external" href="http://infocenter.arm.com/help/topic/com.arm.doc.ihi0053d/IHI0053D_acle_2_1.pdf">ACLE</a>).
Clang uses the <tt class="docutils literal"><span class="pre">binary16</span></tt> format from IEEE 754-2008 for <tt class="docutils literal"><span class="pre">__fp16</span></tt>, not the ARM
alternative format.</p>
<p><tt class="docutils literal"><span class="pre">_Float16</span></tt> is an extended floating-point type.  This means that, just like arithmetic on
<tt class="docutils literal"><span class="pre">float</span></tt> or <tt class="docutils literal"><span class="pre">double</span></tt>, arithmetic on <tt class="docutils literal"><span class="pre">_Float16</span></tt> operands is formally performed in the
<tt class="docutils literal"><span class="pre">_Float16</span></tt> type, so that e.g. the result of adding two <tt class="docutils literal"><span class="pre">_Float16</span></tt> values has type
<tt class="docutils literal"><span class="pre">_Float16</span></tt>.  The behavior of <tt class="docutils literal"><span class="pre">_Float16</span></tt> is specified by ISO/IEC TS 18661-3:2015
(&#8220;Floating-point extensions for C&#8221;).  As with <tt class="docutils literal"><span class="pre">__fp16</span></tt>, Clang uses the <tt class="docutils literal"><span class="pre">binary16</span></tt>
format from IEEE 754-2008 for <tt class="docutils literal"><span class="pre">_Float16</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">_Float16</span></tt> arithmetic will be performed using native half-precision support
when available on the target (e.g. on ARMv8.2a); otherwise it will be performed
at a higher precision (currently always <tt class="docutils literal"><span class="pre">float</span></tt>) and then truncated down to
<tt class="docutils literal"><span class="pre">_Float16</span></tt>.  Note that C and C++ allow intermediate floating-point operands
of an expression to be computed with greater precision than is expressible in
their type, so Clang may avoid intermediate truncations in certain cases; this may
lead to results that are inconsistent with native arithmetic.</p>
<p>It is recommended that portable code use <tt class="docutils literal"><span class="pre">_Float16</span></tt> instead of <tt class="docutils literal"><span class="pre">__fp16</span></tt>,
as it has been defined by the C standards committee and has behavior that is
more familiar to most programmers.</p>
<p>Because <tt class="docutils literal"><span class="pre">__fp16</span></tt> operands are always immediately promoted to <tt class="docutils literal"><span class="pre">float</span></tt>, the
common real type of <tt class="docutils literal"><span class="pre">__fp16</span></tt> and <tt class="docutils literal"><span class="pre">_Float16</span></tt> for the purposes of the usual
arithmetic conversions is <tt class="docutils literal"><span class="pre">float</span></tt>.</p>
<p>A literal can be given <tt class="docutils literal"><span class="pre">_Float16</span></tt> type using the suffix <tt class="docutils literal"><span class="pre">f16</span></tt>; for example:
<tt class="docutils literal"><span class="pre">`</span>
<span class="pre">3.14f16</span>
<span class="pre">`</span></tt></p>
<p>Because default argument promotion only applies to the standard floating-point
types, <tt class="docutils literal"><span class="pre">_Float16</span></tt> values are not promoted to <tt class="docutils literal"><span class="pre">double</span></tt> when passed as variadic
or untyped arguments.  As a consequence, some caution must be taken when using
certain library facilities with <tt class="docutils literal"><span class="pre">_Float16</span></tt>; for example, there is no <tt class="docutils literal"><span class="pre">printf</span></tt> format
specifier for <tt class="docutils literal"><span class="pre">_Float16</span></tt>, and (unlike <tt class="docutils literal"><span class="pre">float</span></tt>) it will not be implicitly promoted to
<tt class="docutils literal"><span class="pre">double</span></tt> when passed to <tt class="docutils literal"><span class="pre">printf</span></tt>, so the programmer must explicitly cast it to
<tt class="docutils literal"><span class="pre">double</span></tt> before using it with an <tt class="docutils literal"><span class="pre">%f</span></tt> or similar specifier.</p>
</div>
<div class="section" id="messages-on-deprecated-and-unavailable-attributes">
<h2><a class="toc-backref" href="#id7">Messages on <tt class="docutils literal"><span class="pre">deprecated</span></tt> and <tt class="docutils literal"><span class="pre">unavailable</span></tt> Attributes</a><a class="headerlink" href="#messages-on-deprecated-and-unavailable-attributes" title="Permalink to this headline">¶</a></h2>
<p>An optional string message can be added to the <tt class="docutils literal"><span class="pre">deprecated</span></tt> and
<tt class="docutils literal"><span class="pre">unavailable</span></tt> attributes.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">void</span> <span class="n">explode</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">deprecated</span><span class="p">(</span><span class="s">&quot;extremely unsafe, use &#39;combust&#39; instead!!!&quot;</span><span class="p">)));</span>
</pre></div>
</div>
<p>If the deprecated or unavailable declaration is used, the message will be
incorporated into the appropriate diagnostic:</p>
<div class="highlight-none"><div class="highlight"><pre>harmless.c:4:3: warning: &#39;explode&#39; is deprecated: extremely unsafe, use &#39;combust&#39; instead!!!
      [-Wdeprecated-declarations]
  explode();
  ^
</pre></div>
</div>
<p>Query for this feature with
<tt class="docutils literal"><span class="pre">__has_extension(attribute_deprecated_with_message)</span></tt> and
<tt class="docutils literal"><span class="pre">__has_extension(attribute_unavailable_with_message)</span></tt>.</p>
</div>
<div class="section" id="attributes-on-enumerators">
<h2><a class="toc-backref" href="#id8">Attributes on Enumerators</a><a class="headerlink" href="#attributes-on-enumerators" title="Permalink to this headline">¶</a></h2>
<p>Clang allows attributes to be written on individual enumerators.  This allows
enumerators to be deprecated, made unavailable, etc.  The attribute must appear
after the enumerator name and before any initializer, like so:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">enum</span> <span class="n">OperationMode</span> <span class="p">{</span>
  <span class="n">OM_Invalid</span><span class="p">,</span>
  <span class="n">OM_Normal</span><span class="p">,</span>
  <span class="n">OM_Terrified</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">deprecated</span><span class="p">)),</span>
  <span class="n">OM_AbortOnError</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">deprecated</span><span class="p">))</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Attributes on the <tt class="docutils literal"><span class="pre">enum</span></tt> declaration do not apply to individual enumerators.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_extension(enumerator_attributes)</span></tt>.</p>
</div>
<div class="section" id="user-specified-system-frameworks">
<h2><a class="toc-backref" href="#id9">&#8216;User-Specified&#8217; System Frameworks</a><a class="headerlink" href="#user-specified-system-frameworks" title="Permalink to this headline">¶</a></h2>
<p>Clang provides a mechanism by which frameworks can be built in such a way that
they will always be treated as being &#8220;system frameworks&#8221;, even if they are not
present in a system framework directory.  This can be useful to system
framework developers who want to be able to test building other applications
with development builds of their framework, including the manner in which the
compiler changes warning behavior for system headers.</p>
<p>Framework developers can opt-in to this mechanism by creating a
&#8220;<tt class="docutils literal"><span class="pre">.system_framework</span></tt>&#8221; file at the top-level of their framework.  That is, the
framework should have contents like:</p>
<div class="highlight-none"><div class="highlight"><pre>.../TestFramework.framework
.../TestFramework.framework/.system_framework
.../TestFramework.framework/Headers
.../TestFramework.framework/Headers/TestFramework.h
...
</pre></div>
</div>
<p>Clang will treat the presence of this file as an indicator that the framework
should be treated as a system framework, regardless of how it was found in the
framework search path.  For consistency, we recommend that such files never be
included in installed versions of the framework.</p>
</div>
<div class="section" id="checks-for-standard-language-features">
<h2><a class="toc-backref" href="#id10">Checks for Standard Language Features</a><a class="headerlink" href="#checks-for-standard-language-features" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">__has_feature</span></tt> macro can be used to query if certain standard language
features are enabled.  The <tt class="docutils literal"><span class="pre">__has_extension</span></tt> macro can be used to query if
language features are available as an extension when compiling for a standard
which does not provide them.  The features which can be tested are listed here.</p>
<p>Since Clang 3.4, the C++ SD-6 feature test macros are also supported.
These are macros with names of the form <tt class="docutils literal"><span class="pre">__cpp_&lt;feature_name&gt;</span></tt>, and are
intended to be a portable way to query the supported features of the compiler.
See <a class="reference external" href="https://clang.llvm.org/cxx_status.html#ts">the C++ status page</a> for
information on the version of SD-6 supported by each Clang release, and the
macros provided by that revision of the recommendations.</p>
<div class="section" id="c-98">
<h3>C++98<a class="headerlink" href="#c-98" title="Permalink to this headline">¶</a></h3>
<p>The features listed below are part of the C++98 standard.  These features are
enabled by default when compiling C++ code.</p>
<div class="section" id="c-exceptions">
<h4>C++ exceptions<a class="headerlink" href="#c-exceptions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_exceptions)</span></tt> to determine if C++ exceptions have been
enabled.  For example, compiling code with <tt class="docutils literal"><span class="pre">-fno-exceptions</span></tt> disables C++
exceptions.</p>
</div>
<div class="section" id="c-rtti">
<h4>C++ RTTI<a class="headerlink" href="#c-rtti" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_rtti)</span></tt> to determine if C++ RTTI has been enabled.  For
example, compiling code with <tt class="docutils literal"><span class="pre">-fno-rtti</span></tt> disables the use of RTTI.</p>
</div>
</div>
<div class="section" id="c-11">
<h3>C++11<a class="headerlink" href="#c-11" title="Permalink to this headline">¶</a></h3>
<p>The features listed below are part of the C++11 standard.  As a result, all
these features are enabled with the <tt class="docutils literal"><span class="pre">-std=c++11</span></tt> or <tt class="docutils literal"><span class="pre">-std=gnu++11</span></tt> option
when compiling C++ code.</p>
<div class="section" id="c-11-sfinae-includes-access-control">
<h4>C++11 SFINAE includes access control<a class="headerlink" href="#c-11-sfinae-includes-access-control" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_access_control_sfinae)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_access_control_sfinae)</span></tt> to determine whether
access-control errors (e.g., calling a private constructor) are considered to
be template argument deduction errors (aka SFINAE errors), per <a class="reference external" href="http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1170">C++ DR1170</a>.</p>
</div>
<div class="section" id="c-11-alias-templates">
<h4>C++11 alias templates<a class="headerlink" href="#c-11-alias-templates" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_alias_templates)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_alias_templates)</span></tt> to determine if support for C++11&#8217;s
alias declarations and alias templates is enabled.</p>
</div>
<div class="section" id="c-11-alignment-specifiers">
<h4>C++11 alignment specifiers<a class="headerlink" href="#c-11-alignment-specifiers" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_alignas)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_alignas)</span></tt> to
determine if support for alignment specifiers using <tt class="docutils literal"><span class="pre">alignas</span></tt> is enabled.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_alignof)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_alignof)</span></tt> to
determine if support for the <tt class="docutils literal"><span class="pre">alignof</span></tt> keyword is enabled.</p>
</div>
<div class="section" id="c-11-attributes">
<h4>C++11 attributes<a class="headerlink" href="#c-11-attributes" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_attributes)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_attributes)</span></tt> to
determine if support for attribute parsing with C++11&#8217;s square bracket notation
is enabled.</p>
</div>
<div class="section" id="c-11-generalized-constant-expressions">
<h4>C++11 generalized constant expressions<a class="headerlink" href="#c-11-generalized-constant-expressions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_constexpr)</span></tt> to determine if support for generalized
constant expressions (e.g., <tt class="docutils literal"><span class="pre">constexpr</span></tt>) is enabled.</p>
</div>
<div class="section" id="c-11-decltype">
<h4>C++11 <tt class="docutils literal"><span class="pre">decltype()</span></tt><a class="headerlink" href="#c-11-decltype" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_decltype)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_decltype)</span></tt> to
determine if support for the <tt class="docutils literal"><span class="pre">decltype()</span></tt> specifier is enabled.  C++11&#8217;s
<tt class="docutils literal"><span class="pre">decltype</span></tt> does not require type-completeness of a function call expression.
Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_decltype_incomplete_return_types)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_decltype_incomplete_return_types)</span></tt> to determine if
support for this feature is enabled.</p>
</div>
<div class="section" id="c-11-default-template-arguments-in-function-templates">
<h4>C++11 default template arguments in function templates<a class="headerlink" href="#c-11-default-template-arguments-in-function-templates" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_default_function_template_args)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_default_function_template_args)</span></tt> to determine if support
for default template arguments in function templates is enabled.</p>
</div>
<div class="section" id="c-11-defaulted-functions">
<h4>C++11 <tt class="docutils literal"><span class="pre">default</span></tt>ed functions<a class="headerlink" href="#c-11-defaulted-functions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_defaulted_functions)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_defaulted_functions)</span></tt> to determine if support for
defaulted function definitions (with <tt class="docutils literal"><span class="pre">=</span> <span class="pre">default</span></tt>) is enabled.</p>
</div>
<div class="section" id="c-11-delegating-constructors">
<h4>C++11 delegating constructors<a class="headerlink" href="#c-11-delegating-constructors" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_delegating_constructors)</span></tt> to determine if support for
delegating constructors is enabled.</p>
</div>
<div class="section" id="c-11-deleted-functions">
<h4>C++11 <tt class="docutils literal"><span class="pre">deleted</span></tt> functions<a class="headerlink" href="#c-11-deleted-functions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_deleted_functions)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_deleted_functions)</span></tt> to determine if support for deleted
function definitions (with <tt class="docutils literal"><span class="pre">=</span> <span class="pre">delete</span></tt>) is enabled.</p>
</div>
<div class="section" id="c-11-explicit-conversion-functions">
<h4>C++11 explicit conversion functions<a class="headerlink" href="#c-11-explicit-conversion-functions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_explicit_conversions)</span></tt> to determine if support for
<tt class="docutils literal"><span class="pre">explicit</span></tt> conversion functions is enabled.</p>
</div>
<div class="section" id="c-11-generalized-initializers">
<h4>C++11 generalized initializers<a class="headerlink" href="#c-11-generalized-initializers" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_generalized_initializers)</span></tt> to determine if support for
generalized initializers (using braced lists and <tt class="docutils literal"><span class="pre">std::initializer_list</span></tt>) is
enabled.</p>
</div>
<div class="section" id="c-11-implicit-move-constructors-assignment-operators">
<h4>C++11 implicit move constructors/assignment operators<a class="headerlink" href="#c-11-implicit-move-constructors-assignment-operators" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_implicit_moves)</span></tt> to determine if Clang will implicitly
generate move constructors and move assignment operators where needed.</p>
</div>
<div class="section" id="c-11-inheriting-constructors">
<h4>C++11 inheriting constructors<a class="headerlink" href="#c-11-inheriting-constructors" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_inheriting_constructors)</span></tt> to determine if support for
inheriting constructors is enabled.</p>
</div>
<div class="section" id="c-11-inline-namespaces">
<h4>C++11 inline namespaces<a class="headerlink" href="#c-11-inline-namespaces" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_inline_namespaces)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_inline_namespaces)</span></tt> to determine if support for inline
namespaces is enabled.</p>
</div>
<div class="section" id="c-11-lambdas">
<h4>C++11 lambdas<a class="headerlink" href="#c-11-lambdas" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_lambdas)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_lambdas)</span></tt> to
determine if support for lambdas is enabled.</p>
</div>
<div class="section" id="c-11-local-and-unnamed-types-as-template-arguments">
<h4>C++11 local and unnamed types as template arguments<a class="headerlink" href="#c-11-local-and-unnamed-types-as-template-arguments" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_local_type_template_args)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_local_type_template_args)</span></tt> to determine if support for
local and unnamed types as template arguments is enabled.</p>
</div>
<div class="section" id="c-11-noexcept">
<h4>C++11 noexcept<a class="headerlink" href="#c-11-noexcept" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_noexcept)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_noexcept)</span></tt> to
determine if support for noexcept exception specifications is enabled.</p>
</div>
<div class="section" id="c-11-in-class-non-static-data-member-initialization">
<h4>C++11 in-class non-static data member initialization<a class="headerlink" href="#c-11-in-class-non-static-data-member-initialization" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_nonstatic_member_init)</span></tt> to determine whether in-class
initialization of non-static data members is enabled.</p>
</div>
<div class="section" id="c-11-nullptr">
<h4>C++11 <tt class="docutils literal"><span class="pre">nullptr</span></tt><a class="headerlink" href="#c-11-nullptr" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_nullptr)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_nullptr)</span></tt> to
determine if support for <tt class="docutils literal"><span class="pre">nullptr</span></tt> is enabled.</p>
</div>
<div class="section" id="c-11-override-control">
<h4>C++11 <tt class="docutils literal"><span class="pre">override</span> <span class="pre">control</span></tt><a class="headerlink" href="#c-11-override-control" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_override_control)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_override_control)</span></tt> to determine if support for the
override control keywords is enabled.</p>
</div>
<div class="section" id="c-11-reference-qualified-functions">
<h4>C++11 reference-qualified functions<a class="headerlink" href="#c-11-reference-qualified-functions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_reference_qualified_functions)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_reference_qualified_functions)</span></tt> to determine if support
for reference-qualified functions (e.g., member functions with <tt class="docutils literal"><span class="pre">&amp;</span></tt> or <tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt>
applied to <tt class="docutils literal"><span class="pre">*this</span></tt>) is enabled.</p>
</div>
<div class="section" id="c-11-range-based-for-loop">
<h4>C++11 range-based <tt class="docutils literal"><span class="pre">for</span></tt> loop<a class="headerlink" href="#c-11-range-based-for-loop" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_range_for)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_range_for)</span></tt> to
determine if support for the range-based for loop is enabled.</p>
</div>
<div class="section" id="c-11-raw-string-literals">
<h4>C++11 raw string literals<a class="headerlink" href="#c-11-raw-string-literals" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_raw_string_literals)</span></tt> to determine if support for raw
string literals (e.g., <tt class="docutils literal"><span class="pre">R&quot;x(foo\bar)x&quot;</span></tt>) is enabled.</p>
</div>
<div class="section" id="c-11-rvalue-references">
<h4>C++11 rvalue references<a class="headerlink" href="#c-11-rvalue-references" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_rvalue_references)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_rvalue_references)</span></tt> to determine if support for rvalue
references is enabled.</p>
</div>
<div class="section" id="c-11-static-assert">
<h4>C++11 <tt class="docutils literal"><span class="pre">static_assert()</span></tt><a class="headerlink" href="#c-11-static-assert" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_static_assert)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_static_assert)</span></tt> to determine if support for compile-time
assertions using <tt class="docutils literal"><span class="pre">static_assert</span></tt> is enabled.</p>
</div>
<div class="section" id="c-11-thread-local">
<h4>C++11 <tt class="docutils literal"><span class="pre">thread_local</span></tt><a class="headerlink" href="#c-11-thread-local" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_thread_local)</span></tt> to determine if support for
<tt class="docutils literal"><span class="pre">thread_local</span></tt> variables is enabled.</p>
</div>
<div class="section" id="c-11-type-inference">
<h4>C++11 type inference<a class="headerlink" href="#c-11-type-inference" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_auto_type)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(cxx_auto_type)</span></tt> to
determine C++11 type inference is supported using the <tt class="docutils literal"><span class="pre">auto</span></tt> specifier.  If
this is disabled, <tt class="docutils literal"><span class="pre">auto</span></tt> will instead be a storage class specifier, as in C
or C++98.</p>
</div>
<div class="section" id="c-11-strongly-typed-enumerations">
<h4>C++11 strongly typed enumerations<a class="headerlink" href="#c-11-strongly-typed-enumerations" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_strong_enums)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_strong_enums)</span></tt> to determine if support for strongly
typed, scoped enumerations is enabled.</p>
</div>
<div class="section" id="c-11-trailing-return-type">
<h4>C++11 trailing return type<a class="headerlink" href="#c-11-trailing-return-type" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_trailing_return)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_trailing_return)</span></tt> to determine if support for the
alternate function declaration syntax with trailing return type is enabled.</p>
</div>
<div class="section" id="c-11-unicode-string-literals">
<h4>C++11 Unicode string literals<a class="headerlink" href="#c-11-unicode-string-literals" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_unicode_literals)</span></tt> to determine if support for Unicode
string literals is enabled.</p>
</div>
<div class="section" id="c-11-unrestricted-unions">
<h4>C++11 unrestricted unions<a class="headerlink" href="#c-11-unrestricted-unions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_unrestricted_unions)</span></tt> to determine if support for
unrestricted unions is enabled.</p>
</div>
<div class="section" id="c-11-user-defined-literals">
<h4>C++11 user-defined literals<a class="headerlink" href="#c-11-user-defined-literals" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_user_literals)</span></tt> to determine if support for
user-defined literals is enabled.</p>
</div>
<div class="section" id="c-11-variadic-templates">
<h4>C++11 variadic templates<a class="headerlink" href="#c-11-variadic-templates" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_variadic_templates)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_variadic_templates)</span></tt> to determine if support for
variadic templates is enabled.</p>
</div>
</div>
<div class="section" id="c-14">
<h3>C++14<a class="headerlink" href="#c-14" title="Permalink to this headline">¶</a></h3>
<p>The features listed below are part of the C++14 standard.  As a result, all
these features are enabled with the <tt class="docutils literal"><span class="pre">-std=C++14</span></tt> or <tt class="docutils literal"><span class="pre">-std=gnu++14</span></tt> option
when compiling C++ code.</p>
<div class="section" id="c-14-binary-literals">
<h4>C++14 binary literals<a class="headerlink" href="#c-14-binary-literals" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_binary_literals)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_binary_literals)</span></tt> to determine whether
binary literals (for instance, <tt class="docutils literal"><span class="pre">0b10010</span></tt>) are recognized. Clang supports this
feature as an extension in all language modes.</p>
</div>
<div class="section" id="c-14-contextual-conversions">
<h4>C++14 contextual conversions<a class="headerlink" href="#c-14-contextual-conversions" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_contextual_conversions)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_contextual_conversions)</span></tt> to determine if the C++14 rules
are used when performing an implicit conversion for an array bound in a
<em>new-expression</em>, the operand of a <em>delete-expression</em>, an integral constant
expression, or a condition in a <tt class="docutils literal"><span class="pre">switch</span></tt> statement.</p>
</div>
<div class="section" id="c-14-decltype-auto">
<h4>C++14 decltype(auto)<a class="headerlink" href="#c-14-decltype-auto" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_decltype_auto)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_decltype_auto)</span></tt> to determine if support
for the <tt class="docutils literal"><span class="pre">decltype(auto)</span></tt> placeholder type is enabled.</p>
</div>
<div class="section" id="c-14-default-initializers-for-aggregates">
<h4>C++14 default initializers for aggregates<a class="headerlink" href="#c-14-default-initializers-for-aggregates" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_aggregate_nsdmi)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_aggregate_nsdmi)</span></tt> to determine if support
for default initializers in aggregate members is enabled.</p>
</div>
<div class="section" id="c-14-digit-separators">
<h4>C++14 digit separators<a class="headerlink" href="#c-14-digit-separators" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__cpp_digit_separators</span></tt> to determine if support for digit separators
using single quotes (for instance, <tt class="docutils literal"><span class="pre">10'000</span></tt>) is enabled. At this time, there
is no corresponding <tt class="docutils literal"><span class="pre">__has_feature</span></tt> name</p>
</div>
<div class="section" id="c-14-generalized-lambda-capture">
<h4>C++14 generalized lambda capture<a class="headerlink" href="#c-14-generalized-lambda-capture" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_init_captures)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_init_captures)</span></tt> to determine if support for
lambda captures with explicit initializers is enabled
(for instance, <tt class="docutils literal"><span class="pre">[n(0)]</span> <span class="pre">{</span> <span class="pre">return</span> <span class="pre">++n;</span> <span class="pre">}</span></tt>).</p>
</div>
<div class="section" id="c-14-generic-lambdas">
<h4>C++14 generic lambdas<a class="headerlink" href="#c-14-generic-lambdas" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_generic_lambdas)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_generic_lambdas)</span></tt> to determine if support for generic
(polymorphic) lambdas is enabled
(for instance, <tt class="docutils literal"><span class="pre">[]</span> <span class="pre">(auto</span> <span class="pre">x)</span> <span class="pre">{</span> <span class="pre">return</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">1;</span> <span class="pre">}</span></tt>).</p>
</div>
<div class="section" id="c-14-relaxed-constexpr">
<h4>C++14 relaxed constexpr<a class="headerlink" href="#c-14-relaxed-constexpr" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_relaxed_constexpr)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_relaxed_constexpr)</span></tt> to determine if variable
declarations, local variable modification, and control flow constructs
are permitted in <tt class="docutils literal"><span class="pre">constexpr</span></tt> functions.</p>
</div>
<div class="section" id="c-14-return-type-deduction">
<h4>C++14 return type deduction<a class="headerlink" href="#c-14-return-type-deduction" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_return_type_deduction)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_return_type_deduction)</span></tt> to determine if support
for return type deduction for functions (using <tt class="docutils literal"><span class="pre">auto</span></tt> as a return type)
is enabled.</p>
</div>
<div class="section" id="c-14-runtime-sized-arrays">
<h4>C++14 runtime-sized arrays<a class="headerlink" href="#c-14-runtime-sized-arrays" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_runtime_array)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_runtime_array)</span></tt> to determine if support
for arrays of runtime bound (a restricted form of variable-length arrays)
is enabled.
Clang&#8217;s implementation of this feature is incomplete.</p>
</div>
<div class="section" id="c-14-variable-templates">
<h4>C++14 variable templates<a class="headerlink" href="#c-14-variable-templates" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(cxx_variable_templates)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(cxx_variable_templates)</span></tt> to determine if support for
templated variable declarations is enabled.</p>
</div>
</div>
<div class="section" id="c11">
<h3>C11<a class="headerlink" href="#c11" title="Permalink to this headline">¶</a></h3>
<p>The features listed below are part of the C11 standard.  As a result, all these
features are enabled with the <tt class="docutils literal"><span class="pre">-std=c11</span></tt> or <tt class="docutils literal"><span class="pre">-std=gnu11</span></tt> option when
compiling C code.  Additionally, because these features are all
backward-compatible, they are available as extensions in all language modes.</p>
<div class="section" id="c11-alignment-specifiers">
<h4>C11 alignment specifiers<a class="headerlink" href="#c11-alignment-specifiers" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_alignas)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(c_alignas)</span></tt> to determine
if support for alignment specifiers using <tt class="docutils literal"><span class="pre">_Alignas</span></tt> is enabled.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_alignof)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(c_alignof)</span></tt> to determine
if support for the <tt class="docutils literal"><span class="pre">_Alignof</span></tt> keyword is enabled.</p>
</div>
<div class="section" id="c11-atomic-operations">
<h4>C11 atomic operations<a class="headerlink" href="#c11-atomic-operations" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_atomic)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(c_atomic)</span></tt> to determine
if support for atomic types using <tt class="docutils literal"><span class="pre">_Atomic</span></tt> is enabled.  Clang also provides
<a class="reference internal" href="#langext-c11-atomic"><em>a set of builtins</em></a> which can be used to implement
the <tt class="docutils literal"><span class="pre">&lt;stdatomic.h&gt;</span></tt> operations on <tt class="docutils literal"><span class="pre">_Atomic</span></tt> types. Use
<tt class="docutils literal"><span class="pre">__has_include(&lt;stdatomic.h&gt;)</span></tt> to determine if C11&#8217;s <tt class="docutils literal"><span class="pre">&lt;stdatomic.h&gt;</span></tt> header
is available.</p>
<p>Clang will use the system&#8217;s <tt class="docutils literal"><span class="pre">&lt;stdatomic.h&gt;</span></tt> header when one is available, and
will otherwise use its own. When using its own, implementations of the atomic
operations are provided as macros. In the cases where C11 also requires a real
function, this header provides only the declaration of that function (along
with a shadowing macro implementation), and you must link to a library which
provides a definition of the function if you use it instead of the macro.</p>
</div>
<div class="section" id="c11-generic-selections">
<h4>C11 generic selections<a class="headerlink" href="#c11-generic-selections" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_generic_selections)</span></tt> or
<tt class="docutils literal"><span class="pre">__has_extension(c_generic_selections)</span></tt> to determine if support for generic
selections is enabled.</p>
<p>As an extension, the C11 generic selection expression is available in all
languages supported by Clang.  The syntax is the same as that given in the C11
standard.</p>
<p>In C, type compatibility is decided according to the rules given in the
appropriate standard, but in C++, which lacks the type compatibility rules used
in C, types are considered compatible only if they are equivalent.</p>
</div>
<div class="section" id="c11-static-assert">
<h4>C11 <tt class="docutils literal"><span class="pre">_Static_assert()</span></tt><a class="headerlink" href="#c11-static-assert" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_static_assert)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(c_static_assert)</span></tt>
to determine if support for compile-time assertions using <tt class="docutils literal"><span class="pre">_Static_assert</span></tt> is
enabled.</p>
</div>
<div class="section" id="c11-thread-local">
<h4>C11 <tt class="docutils literal"><span class="pre">_Thread_local</span></tt><a class="headerlink" href="#c11-thread-local" title="Permalink to this headline">¶</a></h4>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(c_thread_local)</span></tt> or <tt class="docutils literal"><span class="pre">__has_extension(c_thread_local)</span></tt>
to determine if support for <tt class="docutils literal"><span class="pre">_Thread_local</span></tt> variables is enabled.</p>
</div>
</div>
<div class="section" id="modules">
<h3>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h3>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(modules)</span></tt> to determine if Modules have been enabled.
For example, compiling code with <tt class="docutils literal"><span class="pre">-fmodules</span></tt> enables the use of Modules.</p>
<p>More information could be found <a class="reference external" href="https://clang.llvm.org/docs/Modules.html">here</a>.</p>
</div>
</div>
<div class="section" id="checks-for-type-trait-primitives">
<h2><a class="toc-backref" href="#id11">Checks for Type Trait Primitives</a><a class="headerlink" href="#checks-for-type-trait-primitives" title="Permalink to this headline">¶</a></h2>
<p>Type trait primitives are special builtin constant expressions that can be used
by the standard C++ library to facilitate or simplify the implementation of
user-facing type traits in the &lt;type_traits&gt; header.</p>
<p>They are not intended to be used directly by user code because they are
implementation-defined and subject to change &#8211; as such they&#8217;re tied closely to
the supported set of system headers, currently:</p>
<ul class="simple">
<li>LLVM&#8217;s own libc++</li>
<li>GNU libstdc++</li>
<li>The Microsoft standard C++ library</li>
</ul>
<p>Clang supports the <a class="reference external" href="http://gcc.gnu.org/onlinedocs/gcc/Type-Traits.html">GNU C++ type traits</a> and a subset of the
<a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms177194(v=VS.100).aspx">Microsoft Visual C++ Type traits</a>.</p>
<p>Feature detection is supported only for some of the primitives at present. User
code should not use these checks because they bear no direct relation to the
actual set of type traits supported by the C++ standard library.</p>
<p>For type trait <tt class="docutils literal"><span class="pre">__X</span></tt>, <tt class="docutils literal"><span class="pre">__has_extension(X)</span></tt> indicates the presence of the
type trait primitive in the compiler. A simplistic usage example as might be
seen in standard C++ headers follows:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#if __has_extension(is_convertible_to)</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">From</span><span class="p">,</span> <span class="k">typename</span> <span class="n">To</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="n">is_convertible_to</span> <span class="p">{</span>
  <span class="k">static</span> <span class="k">const</span> <span class="kt">bool</span> <span class="n">value</span> <span class="o">=</span> <span class="n">__is_convertible_to</span><span class="p">(</span><span class="n">From</span><span class="p">,</span> <span class="n">To</span><span class="p">);</span>
<span class="p">};</span>
<span class="cp">#else</span>
<span class="c1">// Emulate type trait for compatibility with other compilers.</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>The following type trait primitives are supported by Clang:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__has_nothrow_assign</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_nothrow_copy</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_nothrow_constructor</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_trivial_assign</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_trivial_copy</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_trivial_constructor</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_trivial_destructor</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__has_virtual_destructor</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_abstract</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_aggregate</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_base_of</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_class</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_convertible_to</span></tt> (Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_empty</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_enum</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_interface_class</span></tt> (Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_pod</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_polymorphic</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_union</span></tt> (GNU, Microsoft)</li>
<li><tt class="docutils literal"><span class="pre">__is_literal(type)</span></tt>: Determines whether the given type is a literal type</li>
<li><tt class="docutils literal"><span class="pre">__is_final</span></tt>: Determines whether the given type is declared with a
<tt class="docutils literal"><span class="pre">final</span></tt> class-virt-specifier.</li>
<li><tt class="docutils literal"><span class="pre">__underlying_type(type)</span></tt>: Retrieves the underlying type for a given
<tt class="docutils literal"><span class="pre">enum</span></tt> type.  This trait is required to implement the C++11 standard
library.</li>
<li><tt class="docutils literal"><span class="pre">__is_trivially_assignable(totype,</span> <span class="pre">fromtype)</span></tt>: Determines whether a value
of type <tt class="docutils literal"><span class="pre">totype</span></tt> can be assigned to from a value of type <tt class="docutils literal"><span class="pre">fromtype</span></tt> such
that no non-trivial functions are called as part of that assignment.  This
trait is required to implement the C++11 standard library.</li>
<li><tt class="docutils literal"><span class="pre">__is_trivially_constructible(type,</span> <span class="pre">argtypes...)</span></tt>: Determines whether a
value of type <tt class="docutils literal"><span class="pre">type</span></tt> can be direct-initialized with arguments of types
<tt class="docutils literal"><span class="pre">argtypes...</span></tt> such that no non-trivial functions are called as part of
that initialization.  This trait is required to implement the C++11 standard
library.</li>
<li><tt class="docutils literal"><span class="pre">__is_destructible</span></tt> (MSVC 2013)</li>
<li><tt class="docutils literal"><span class="pre">__is_nothrow_destructible</span></tt> (MSVC 2013)</li>
<li><tt class="docutils literal"><span class="pre">__is_nothrow_assignable</span></tt> (MSVC 2013, clang)</li>
<li><tt class="docutils literal"><span class="pre">__is_constructible</span></tt> (MSVC 2013, clang)</li>
<li><tt class="docutils literal"><span class="pre">__is_nothrow_constructible</span></tt> (MSVC 2013, clang)</li>
<li><tt class="docutils literal"><span class="pre">__is_assignable</span></tt> (MSVC 2015, clang)</li>
<li><tt class="docutils literal"><span class="pre">__reference_binds_to_temporary(T,</span> <span class="pre">U)</span></tt> (Clang):  Determines whether a
reference of type <tt class="docutils literal"><span class="pre">T</span></tt> bound to an expression of type <tt class="docutils literal"><span class="pre">U</span></tt> would bind to a
materialized temporary object. If <tt class="docutils literal"><span class="pre">T</span></tt> is not a reference type the result
is false. Note this trait will also return false when the initialization of
<tt class="docutils literal"><span class="pre">T</span></tt> from <tt class="docutils literal"><span class="pre">U</span></tt> is ill-formed.</li>
</ul>
</div>
<div class="section" id="blocks">
<h2><a class="toc-backref" href="#id12">Blocks</a><a class="headerlink" href="#blocks" title="Permalink to this headline">¶</a></h2>
<p>The syntax and high level language feature description is in
<a class="reference internal" href="BlockLanguageSpec.html"><em>BlockLanguageSpec</em></a>. Implementation and ABI details for
the clang implementation are in <a class="reference internal" href="Block-ABI-Apple.html"><em>Block-ABI-Apple</em></a>.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_extension(blocks)</span></tt>.</p>
</div>
<div class="section" id="objective-c-features">
<h2><a class="toc-backref" href="#id13">Objective-C Features</a><a class="headerlink" href="#objective-c-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="related-result-types">
<h3>Related result types<a class="headerlink" href="#related-result-types" title="Permalink to this headline">¶</a></h3>
<p>According to Cocoa conventions, Objective-C methods with certain names
(&#8220;<tt class="docutils literal"><span class="pre">init</span></tt>&#8221;, &#8220;<tt class="docutils literal"><span class="pre">alloc</span></tt>&#8221;, etc.) always return objects that are an instance of
the receiving class&#8217;s type.  Such methods are said to have a &#8220;related result
type&#8221;, meaning that a message send to one of these methods will have the same
static type as an instance of the receiver class.  For example, given the
following classes:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@interface</span> <span class="nc">NSObject</span>
<span class="k">+</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">alloc</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">NSArray</span> : <span class="nc">NSObject</span>
<span class="k">@end</span>
</pre></div>
</div>
<p>and this common initialization pattern</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="n">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSArray</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</pre></div>
</div>
<p>the type of the expression <tt class="docutils literal"><span class="pre">[NSArray</span> <span class="pre">alloc]</span></tt> is <tt class="docutils literal"><span class="pre">NSArray*</span></tt> because
<tt class="docutils literal"><span class="pre">alloc</span></tt> implicitly has a related result type.  Similarly, the type of the
expression <tt class="docutils literal"><span class="pre">[[NSArray</span> <span class="pre">alloc]</span> <span class="pre">init]</span></tt> is <tt class="docutils literal"><span class="pre">NSArray*</span></tt>, since <tt class="docutils literal"><span class="pre">init</span></tt> has a
related result type and its receiver is known to have the type <tt class="docutils literal"><span class="pre">NSArray</span> <span class="pre">*</span></tt>.
If neither <tt class="docutils literal"><span class="pre">alloc</span></tt> nor <tt class="docutils literal"><span class="pre">init</span></tt> had a related result type, the expressions
would have had type <tt class="docutils literal"><span class="pre">id</span></tt>, as declared in the method signature.</p>
<p>A method with a related result type can be declared by using the type
<tt class="docutils literal"><span class="pre">instancetype</span></tt> as its result type.  <tt class="docutils literal"><span class="pre">instancetype</span></tt> is a contextual keyword
that is only permitted in the result type of an Objective-C method, e.g.</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@interface</span> <span class="nc">A</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">constructAnA</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>
<p>The related result type can also be inferred for some methods.  To determine
whether a method has an inferred related result type, the first word in the
camel-case selector (e.g., &#8220;<tt class="docutils literal"><span class="pre">init</span></tt>&#8221; in &#8220;<tt class="docutils literal"><span class="pre">initWithObjects</span></tt>&#8221;) is considered,
and the method will have a related result type if its return type is compatible
with the type of its class and if:</p>
<ul class="simple">
<li>the first word is &#8220;<tt class="docutils literal"><span class="pre">alloc</span></tt>&#8221; or &#8220;<tt class="docutils literal"><span class="pre">new</span></tt>&#8221;, and the method is a class method,
or</li>
<li>the first word is &#8220;<tt class="docutils literal"><span class="pre">autorelease</span></tt>&#8221;, &#8220;<tt class="docutils literal"><span class="pre">init</span></tt>&#8221;, &#8220;<tt class="docutils literal"><span class="pre">retain</span></tt>&#8221;, or &#8220;<tt class="docutils literal"><span class="pre">self</span></tt>&#8221;,
and the method is an instance method.</li>
</ul>
<p>If a method with a related result type is overridden by a subclass method, the
subclass method must also return a type that is compatible with the subclass
type.  For example:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@interface</span> <span class="nc">NSString</span> : <span class="nc">NSObject</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSUnrelated</span> <span class="o">*</span><span class="p">)</span><span class="nf">init</span><span class="p">;</span> <span class="c1">// incorrect usage: NSUnrelated is not NSString or a superclass of NSString</span>
<span class="k">@end</span>
</pre></div>
</div>
<p>Related result types only affect the type of a message send or property access
via the given method.  In all other respects, a method with a related result
type is treated the same way as method that returns <tt class="docutils literal"><span class="pre">id</span></tt>.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(objc_instancetype)</span></tt> to determine whether the
<tt class="docutils literal"><span class="pre">instancetype</span></tt> contextual keyword is available.</p>
</div>
<div class="section" id="automatic-reference-counting">
<h3>Automatic reference counting<a class="headerlink" href="#automatic-reference-counting" title="Permalink to this headline">¶</a></h3>
<p>Clang provides support for <a class="reference internal" href="AutomaticReferenceCounting.html"><em>automated reference counting</em></a> in Objective-C, which eliminates the need
for manual <tt class="docutils literal"><span class="pre">retain</span></tt>/<tt class="docutils literal"><span class="pre">release</span></tt>/<tt class="docutils literal"><span class="pre">autorelease</span></tt> message sends.  There are three
feature macros associated with automatic reference counting:
<tt class="docutils literal"><span class="pre">__has_feature(objc_arc)</span></tt> indicates the availability of automated reference
counting in general, while <tt class="docutils literal"><span class="pre">__has_feature(objc_arc_weak)</span></tt> indicates that
automated reference counting also includes support for <tt class="docutils literal"><span class="pre">__weak</span></tt> pointers to
Objective-C objects. <tt class="docutils literal"><span class="pre">__has_feature(objc_arc_fields)</span></tt> indicates that C structs
are allowed to have fields that are pointers to Objective-C objects managed by
automatic reference counting.</p>
</div>
<div class="section" id="weak-references">
<span id="objc-weak"></span><h3>Weak references<a class="headerlink" href="#weak-references" title="Permalink to this headline">¶</a></h3>
<p>Clang supports ARC-style weak and unsafe references in Objective-C even
outside of ARC mode.  Weak references must be explicitly enabled with
the <tt class="docutils literal"><span class="pre">-fobjc-weak</span></tt> option; use <tt class="docutils literal"><span class="pre">__has_feature((objc_arc_weak))</span></tt>
to test whether they are enabled.  Unsafe references are enabled
unconditionally.  ARC-style weak and unsafe references cannot be used
when Objective-C garbage collection is enabled.</p>
<p>Except as noted below, the language rules for the <tt class="docutils literal"><span class="pre">__weak</span></tt> and
<tt class="docutils literal"><span class="pre">__unsafe_unretained</span></tt> qualifiers (and the <tt class="docutils literal"><span class="pre">weak</span></tt> and
<tt class="docutils literal"><span class="pre">unsafe_unretained</span></tt> property attributes) are just as laid out
in the <a class="reference internal" href="AutomaticReferenceCounting.html"><em>ARC specification</em></a>.
In particular, note that some classes do not support forming weak
references to their instances, and note that special care must be
taken when storing weak references in memory where initialization
and deinitialization are outside the responsibility of the compiler
(such as in <tt class="docutils literal"><span class="pre">malloc</span></tt>-ed memory).</p>
<p>Loading from a <tt class="docutils literal"><span class="pre">__weak</span></tt> variable always implicitly retains the
loaded value.  In non-ARC modes, this retain is normally balanced
by an implicit autorelease.  This autorelease can be suppressed
by performing the load in the receiver position of a <tt class="docutils literal"><span class="pre">-retain</span></tt>
message send (e.g. <tt class="docutils literal"><span class="pre">[weakReference</span> <span class="pre">retain]</span></tt>); note that this performs
only a single retain (the retain done when primitively loading from
the weak reference).</p>
<p>For the most part, <tt class="docutils literal"><span class="pre">__unsafe_unretained</span></tt> in non-ARC modes is just the
default behavior of variables and therefore is not needed.  However,
it does have an effect on the semantics of block captures: normally,
copying a block which captures an Objective-C object or block pointer
causes the captured pointer to be retained or copied, respectively,
but that behavior is suppressed when the captured variable is qualified
with <tt class="docutils literal"><span class="pre">__unsafe_unretained</span></tt>.</p>
<p>Note that the <tt class="docutils literal"><span class="pre">__weak</span></tt> qualifier formerly meant the GC qualifier in
all non-ARC modes and was silently ignored outside of GC modes.  It now
means the ARC-style qualifier in all non-GC modes and is no longer
allowed if not enabled by either <tt class="docutils literal"><span class="pre">-fobjc-arc</span></tt> or <tt class="docutils literal"><span class="pre">-fobjc-weak</span></tt>.
It is expected that <tt class="docutils literal"><span class="pre">-fobjc-weak</span></tt> will eventually be enabled by default
in all non-GC Objective-C modes.</p>
</div>
<div class="section" id="enumerations-with-a-fixed-underlying-type">
<span id="objc-fixed-enum"></span><h3>Enumerations with a fixed underlying type<a class="headerlink" href="#enumerations-with-a-fixed-underlying-type" title="Permalink to this headline">¶</a></h3>
<p>Clang provides support for C++11 enumerations with a fixed underlying type
within Objective-C.  For example, one can write an enumeration type as:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">enum</span> <span class="o">:</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="p">{</span> <span class="n">Red</span><span class="p">,</span> <span class="n">Green</span><span class="p">,</span> <span class="n">Blue</span> <span class="p">}</span> <span class="n">Color</span><span class="p">;</span>
</pre></div>
</div>
<p>This specifies that the underlying type, which is used to store the enumeration
value, is <tt class="docutils literal"><span class="pre">unsigned</span> <span class="pre">char</span></tt>.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(objc_fixed_enum)</span></tt> to determine whether support for fixed
underlying types is available in Objective-C.</p>
</div>
<div class="section" id="interoperability-with-c-11-lambdas">
<h3>Interoperability with C++11 lambdas<a class="headerlink" href="#interoperability-with-c-11-lambdas" title="Permalink to this headline">¶</a></h3>
<p>Clang provides interoperability between C++11 lambdas and blocks-based APIs, by
permitting a lambda to be implicitly converted to a block pointer with the
corresponding signature.  For example, consider an API such as <tt class="docutils literal"><span class="pre">NSArray</span></tt>&#8216;s
array-sorting method:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">-</span> <span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="nf">sortedArrayUsingComparator:</span><span class="p">(</span><span class="n">NSComparator</span><span class="p">)</span><span class="nv">cmptr</span><span class="p">;</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">NSComparator</span></tt> is simply a typedef for the block pointer <tt class="docutils literal"><span class="pre">NSComparisonResult</span>
<span class="pre">(^)(id,</span> <span class="pre">id)</span></tt>, and parameters of this type are generally provided with block
literals as arguments.  However, one can also use a C++11 lambda so long as it
provides the same signature (in this case, accepting two parameters of type
<tt class="docutils literal"><span class="pre">id</span></tt> and returning an <tt class="docutils literal"><span class="pre">NSComparisonResult</span></tt>):</p>
<div class="highlight-objc"><pre>NSArray *array = @[@"string 1", @"string 21", @"string 12", @"String 11",
                   @"String 02"];
const NSStringCompareOptions comparisonOptions
  = NSCaseInsensitiveSearch | NSNumericSearch |
    NSWidthInsensitiveSearch | NSForcedOrderingSearch;
NSLocale *currentLocale = [NSLocale currentLocale];
NSArray *sorted
  = [array sortedArrayUsingComparator:[=](id s1, id s2) -&gt; NSComparisonResult {
             NSRange string1Range = NSMakeRange(0, [s1 length]);
             return [s1 compare:s2 options:comparisonOptions
             range:string1Range locale:currentLocale];
     }];
NSLog(@"sorted: %@", sorted);</pre>
</div>
<p>This code relies on an implicit conversion from the type of the lambda
expression (an unnamed, local class type called the <em>closure type</em>) to the
corresponding block pointer type.  The conversion itself is expressed by a
conversion operator in that closure type that produces a block pointer with the
same signature as the lambda itself, e.g.,</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="n">operator</span> <span class="n">NSComparisonResult</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">id</span><span class="p">,</span> <span class="kt">id</span><span class="p">)()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>
</div>
<p>This conversion function returns a new block that simply forwards the two
parameters to the lambda object (which it captures by copy), then returns the
result.  The returned block is first copied (with <tt class="docutils literal"><span class="pre">Block_copy</span></tt>) and then
autoreleased.  As an optimization, if a lambda expression is immediately
converted to a block pointer (as in the first example, above), then the block
is not copied and autoreleased: rather, it is given the same lifetime as a
block literal written at that point in the program, which avoids the overhead
of copying a block to the heap in the common case.</p>
<p>The conversion from a lambda to a block pointer is only available in
Objective-C++, and not in C++ with blocks, due to its use of Objective-C memory
management (autorelease).</p>
</div>
<div class="section" id="object-literals-and-subscripting">
<h3>Object Literals and Subscripting<a class="headerlink" href="#object-literals-and-subscripting" title="Permalink to this headline">¶</a></h3>
<p>Clang provides support for <a class="reference internal" href="ObjectiveCLiterals.html"><em>Object Literals and Subscripting</em></a> in Objective-C, which simplifies common Objective-C
programming patterns, makes programs more concise, and improves the safety of
container creation.  There are several feature macros associated with object
literals and subscripting: <tt class="docutils literal"><span class="pre">__has_feature(objc_array_literals)</span></tt> tests the
availability of array literals; <tt class="docutils literal"><span class="pre">__has_feature(objc_dictionary_literals)</span></tt>
tests the availability of dictionary literals;
<tt class="docutils literal"><span class="pre">__has_feature(objc_subscripting)</span></tt> tests the availability of object
subscripting.</p>
</div>
<div class="section" id="objective-c-autosynthesis-of-properties">
<h3>Objective-C Autosynthesis of Properties<a class="headerlink" href="#objective-c-autosynthesis-of-properties" title="Permalink to this headline">¶</a></h3>
<p>Clang provides support for autosynthesis of declared properties.  Using this
feature, clang provides default synthesis of those properties not declared
&#64;dynamic and not having user provided backing getter and setter methods.
<tt class="docutils literal"><span class="pre">__has_feature(objc_default_synthesize_properties)</span></tt> checks for availability
of this feature in version of clang being used.</p>
</div>
<div class="section" id="objective-c-retaining-behavior-attributes">
<span id="langext-objc-retain-release"></span><h3>Objective-C retaining behavior attributes<a class="headerlink" href="#objective-c-retaining-behavior-attributes" title="Permalink to this headline">¶</a></h3>
<p>In Objective-C, functions and methods are generally assumed to follow the
<a class="reference external" href="http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html">Cocoa Memory Management</a>
conventions for ownership of object arguments and
return values. However, there are exceptions, and so Clang provides attributes
to allow these exceptions to be documented. This are used by ARC and the
<a class="reference external" href="https://clang-analyzer.llvm.org">static analyzer</a> Some exceptions may be
better described using the <tt class="docutils literal"><span class="pre">objc_method_family</span></tt> attribute instead.</p>
<p><strong>Usage</strong>: The <tt class="docutils literal"><span class="pre">ns_returns_retained</span></tt>, <tt class="docutils literal"><span class="pre">ns_returns_not_retained</span></tt>,
<tt class="docutils literal"><span class="pre">ns_returns_autoreleased</span></tt>, <tt class="docutils literal"><span class="pre">cf_returns_retained</span></tt>, and
<tt class="docutils literal"><span class="pre">cf_returns_not_retained</span></tt> attributes can be placed on methods and functions
that return Objective-C or CoreFoundation objects. They are commonly placed at
the end of a function prototype or method declaration:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="kt">id</span> <span class="n">foo</span><span class="p">()</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ns_returns_retained</span><span class="p">));</span>

<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">bar:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nv">x</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ns_returns_retained</span><span class="p">));</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">*_returns_retained</span></tt> attributes specify that the returned object has a +1
retain count.  The <tt class="docutils literal"><span class="pre">*_returns_not_retained</span></tt> attributes specify that the return
object has a +0 retain count, even if the normal convention for its selector
would be +1.  <tt class="docutils literal"><span class="pre">ns_returns_autoreleased</span></tt> specifies that the returned object is
+0, but is guaranteed to live at least as long as the next flush of an
autorelease pool.</p>
<p><strong>Usage</strong>: The <tt class="docutils literal"><span class="pre">ns_consumed</span></tt> and <tt class="docutils literal"><span class="pre">cf_consumed</span></tt> attributes can be placed on
an parameter declaration; they specify that the argument is expected to have a
+1 retain count, which will be balanced in some way by the function or method.
The <tt class="docutils literal"><span class="pre">ns_consumes_self</span></tt> attribute can only be placed on an Objective-C
method; it specifies that the method expects its <tt class="docutils literal"><span class="pre">self</span></tt> parameter to have a
+1 retain count, which it will balance in some way.</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="kt">void</span> <span class="n">foo</span><span class="p">(</span><span class="n">__attribute__</span><span class="p">((</span><span class="n">ns_consumed</span><span class="p">))</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">string</span><span class="p">);</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">bar</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ns_consumes_self</span><span class="p">));</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">baz:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">ns_consumed</span><span class="p">))</span> <span class="n">x</span><span class="p">;</span>
</pre></div>
</div>
<p>Further examples of these attributes are available in the static analyzer&#8217;s <a class="reference external" href="https://clang-analyzer.llvm.org/annotations.html#cocoa_mem">list of annotations for analysis</a>.</p>
<p>Query for these features with <tt class="docutils literal"><span class="pre">__has_attribute(ns_consumed)</span></tt>,
<tt class="docutils literal"><span class="pre">__has_attribute(ns_returns_retained)</span></tt>, etc.</p>
</div>
<div class="section" id="objective-c-available">
<h3>Objective-C &#64;available<a class="headerlink" href="#objective-c-available" title="Permalink to this headline">¶</a></h3>
<p>It is possible to use the newest SDK but still build a program that can run on
older versions of macOS and iOS by passing <tt class="docutils literal"><span class="pre">-mmacosx-version-min=</span></tt> /
<tt class="docutils literal"><span class="pre">-miphoneos-version-min=</span></tt>.</p>
<p>Before LLVM 5.0, when calling a function that exists only in the OS that&#8217;s
newer than the target OS (as determined by the minimum deployment version),
programmers had to carefully check if the function exists at runtime, using
null checks for weakly-linked C functions, <tt class="docutils literal"><span class="pre">+class</span></tt> for Objective-C classes,
and <tt class="docutils literal"><span class="pre">-respondsToSelector:</span></tt> or <tt class="docutils literal"><span class="pre">+instancesRespondToSelector:</span></tt> for
Objective-C methods.  If such a check was missed, the program would compile
fine, run fine on newer systems, but crash on older systems.</p>
<p>As of LLVM 5.0, <tt class="docutils literal"><span class="pre">-Wunguarded-availability</span></tt> uses the <a class="reference external" href="https://clang.llvm.org/docs/AttributeReference.html#availability">availability attributes</a> together
with the new <tt class="docutils literal"><span class="pre">&#64;available()</span></tt> keyword to assist with this issue.
When a method that&#8217;s introduced in the OS newer than the target OS is called, a
-Wunguarded-availability warning is emitted if that call is not guarded:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">NSSomeClass</span><span class="o">*</span> <span class="n">var</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// If fancyNewMethod was added in e.g. macOS 10.12, but the code is</span>
  <span class="c1">// built with -mmacosx-version-min=10.11, then this unconditional call</span>
  <span class="c1">// will emit a -Wunguarded-availability warning:</span>
  <span class="p">[</span><span class="n">var</span> <span class="n">fancyNewMethod</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To fix the warning and to avoid the crash on macOS 10.11, wrap it in
<tt class="docutils literal"><span class="pre">if(&#64;available())</span></tt>:</p>
<div class="highlight-objc"><pre>void my_fun(NSSomeClass* var) {
  if (@available(macOS 10.12, *)) {
    [var fancyNewMethod];
  } else {
    // Put fallback behavior for old macOS versions (and for non-mac
    // platforms) here.
  }
}</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">*</span></tt> is required and means that platforms not explicitly listed will take
the true branch, and the compiler will emit <tt class="docutils literal"><span class="pre">-Wunguarded-availability</span></tt>
warnings for unlisted platforms based on those platform&#8217;s deployment target.
More than one platform can be listed in <tt class="docutils literal"><span class="pre">&#64;available()</span></tt>:</p>
<div class="highlight-objc"><pre>void my_fun(NSSomeClass* var) {
  if (@available(macOS 10.12, iOS 10, *)) {
    [var fancyNewMethod];
  }
}</pre>
</div>
<p>If the caller of <tt class="docutils literal"><span class="pre">my_fun()</span></tt> already checks that <tt class="docutils literal"><span class="pre">my_fun()</span></tt> is only called
on 10.12, then add an <a class="reference external" href="https://clang.llvm.org/docs/AttributeReference.html#availability">availability attribute</a> to it,
which will also suppress the warning and require that calls to my_fun() are
checked:</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="n">API_AVAILABLE</span><span class="p">(</span><span class="n">macos</span><span class="p">(</span><span class="mf">10.12</span><span class="p">))</span> <span class="kt">void</span> <span class="n">my_fun</span><span class="p">(</span><span class="n">NSSomeClass</span><span class="o">*</span> <span class="n">var</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">var</span> <span class="n">fancyNewMethod</span><span class="p">];</span>  <span class="c1">// Now ok.</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">&#64;available()</span></tt> is only available in Objective-C code.  To use the feature
in C and C++ code, use the <tt class="docutils literal"><span class="pre">__builtin_available()</span></tt> spelling instead.</p>
<p>If existing code uses null checks or <tt class="docutils literal"><span class="pre">-respondsToSelector:</span></tt>, it should
be changed to use <tt class="docutils literal"><span class="pre">&#64;available()</span></tt> (or <tt class="docutils literal"><span class="pre">__builtin_available</span></tt>) instead.</p>
<p><tt class="docutils literal"><span class="pre">-Wunguarded-availability</span></tt> is disabled by default, but
<tt class="docutils literal"><span class="pre">-Wunguarded-availability-new</span></tt>, which only emits this warning for APIs
that have been introduced in macOS &gt;= 10.13, iOS &gt;= 11, watchOS &gt;= 4 and
tvOS &gt;= 11, is enabled by default.</p>
</div>
<div class="section" id="objective-c-abi-protocol-qualifier-mangling-of-parameters">
<span id="langext-overloading"></span><h3>Objective-C++ ABI: protocol-qualifier mangling of parameters<a class="headerlink" href="#objective-c-abi-protocol-qualifier-mangling-of-parameters" title="Permalink to this headline">¶</a></h3>
<p>Starting with LLVM 3.4, Clang produces a new mangling for parameters whose
type is a qualified-<tt class="docutils literal"><span class="pre">id</span></tt> (e.g., <tt class="docutils literal"><span class="pre">id&lt;Foo&gt;</span></tt>).  This mangling allows such
parameters to be differentiated from those with the regular unqualified <tt class="docutils literal"><span class="pre">id</span></tt>
type.</p>
<p>This was a non-backward compatible mangling change to the ABI.  This change
allows proper overloading, and also prevents mangling conflicts with template
parameters of protocol-qualified type.</p>
<p>Query the presence of this new mangling with
<tt class="docutils literal"><span class="pre">__has_feature(objc_protocol_qualifier_mangling)</span></tt>.</p>
</div>
</div>
<div class="section" id="initializer-lists-for-complex-numbers-in-c">
<h2><a class="toc-backref" href="#id14">Initializer lists for complex numbers in C</a><a class="headerlink" href="#initializer-lists-for-complex-numbers-in-c" title="Permalink to this headline">¶</a></h2>
<p>clang supports an extension which allows the following in C:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#include &lt;math.h&gt;</span>
<span class="cp">#include &lt;complex.h&gt;</span>
<span class="n">complex</span> <span class="kt">float</span> <span class="n">x</span> <span class="o">=</span> <span class="p">{</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="n">INFINITY</span> <span class="p">};</span> <span class="c1">// Init to (1, Inf)</span>
</pre></div>
</div>
<p>This construct is useful because there is no way to separately initialize the
real and imaginary parts of a complex variable in standard C, given that clang
does not support <tt class="docutils literal"><span class="pre">_Imaginary</span></tt>.  (Clang also supports the <tt class="docutils literal"><span class="pre">__real__</span></tt> and
<tt class="docutils literal"><span class="pre">__imag__</span></tt> extensions from gcc, which help in some cases, but are not usable
in static initializers.)</p>
<p>Note that this extension does not allow eliding the braces; the meaning of the
following two lines is different:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">complex</span> <span class="kt">float</span> <span class="n">x</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span> <span class="p">}</span> <span class="p">};</span> <span class="c1">// [0] = (1, 1)</span>
<span class="n">complex</span> <span class="kt">float</span> <span class="n">x</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span> <span class="p">};</span> <span class="c1">// [0] = (1, 0), [1] = (1, 0)</span>
</pre></div>
</div>
<p>This extension also works in C++ mode, as far as that goes, but does not apply
to the C++ <tt class="docutils literal"><span class="pre">std::complex</span></tt>.  (In C++11, list initialization allows the same
syntax to be used with <tt class="docutils literal"><span class="pre">std::complex</span></tt> with the same meaning.)</p>
</div>
<div class="section" id="builtin-functions">
<h2><a class="toc-backref" href="#id15">Builtin Functions</a><a class="headerlink" href="#builtin-functions" title="Permalink to this headline">¶</a></h2>
<p>Clang supports a number of builtin library functions with the same syntax as
GCC, including things like <tt class="docutils literal"><span class="pre">__builtin_nan</span></tt>, <tt class="docutils literal"><span class="pre">__builtin_constant_p</span></tt>,
<tt class="docutils literal"><span class="pre">__builtin_choose_expr</span></tt>, <tt class="docutils literal"><span class="pre">__builtin_types_compatible_p</span></tt>,
<tt class="docutils literal"><span class="pre">__builtin_assume_aligned</span></tt>, <tt class="docutils literal"><span class="pre">__sync_fetch_and_add</span></tt>, etc.  In addition to
the GCC builtins, Clang supports a number of builtins that GCC does not, which
are listed here.</p>
<p>Please note that Clang does not and will not support all of the GCC builtins
for vector operations.  Instead of using builtins, you should use the functions
defined in target-specific header files like <tt class="docutils literal"><span class="pre">&lt;xmmintrin.h&gt;</span></tt>, which define
portable wrappers for these.  Many of the Clang versions of these functions are
implemented directly in terms of <a class="reference internal" href="#langext-vectors"><em>extended vector support</em></a> instead of builtins, in order to reduce the number of
builtins that we need to implement.</p>
<div class="section" id="builtin-assume">
<h3><tt class="docutils literal"><span class="pre">__builtin_assume</span></tt><a class="headerlink" href="#builtin-assume" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_assume</span></tt> is used to provide the optimizer with a boolean
invariant that is defined to be true.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_assume</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example of Use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">int</span> <span class="n">foo</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// The optimizer may short-circuit this check using the invariant.</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">do_something</span><span class="p">();</span>

  <span class="k">return</span> <span class="n">do_something_else</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The boolean argument to this function is defined to be true. The optimizer may
analyze the form of the expression provided as the argument and deduce from
that information used to optimize the program. If the condition is violated
during execution, the behavior is undefined. The argument itself is never
evaluated, so any side effects of the expression will be discarded.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_assume)</span></tt>.</p>
</div>
<div class="section" id="builtin-readcyclecounter">
<h3><tt class="docutils literal"><span class="pre">__builtin_readcyclecounter</span></tt><a class="headerlink" href="#builtin-readcyclecounter" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_readcyclecounter</span></tt> is used to access the cycle counter register (or
a similar low-latency, high-accuracy clock) on those targets that support it.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_readcyclecounter</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Example of Use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">__builtin_readcyclecounter</span><span class="p">();</span>
<span class="n">do_something</span><span class="p">();</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">__builtin_readcyclecounter</span><span class="p">();</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">cycles_to_do_something</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">;</span> <span class="c1">// assuming no overflow</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The <tt class="docutils literal"><span class="pre">__builtin_readcyclecounter()</span></tt> builtin returns the cycle counter value,
which may be either global or process/thread-specific depending on the target.
As the backing counters often overflow quickly (on the order of seconds) this
should only be used for timing small intervals.  When not supported by the
target, the return value is always zero.  This builtin takes no arguments and
produces an unsigned long long result.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_readcyclecounter)</span></tt>. Note
that even if present, its use may depend on run-time privilege or other OS
controlled state.</p>
</div>
<div class="section" id="builtin-shufflevector">
<span id="langext-builtin-shufflevector"></span><h3><tt class="docutils literal"><span class="pre">__builtin_shufflevector</span></tt><a class="headerlink" href="#builtin-shufflevector" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_shufflevector</span></tt> is used to express generic vector
permutation/shuffle/swizzle operations.  This builtin is also very important
for the implementation of various target-specific header files like
<tt class="docutils literal"><span class="pre">&lt;xmmintrin.h&gt;</span></tt>.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<p><strong>Examples</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// identity operation - return 4-element vector v1.</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1">// &quot;Splat&quot; element 0 of V1 into a 4-element result.</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">V1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">// Reverse 4-element vector V1.</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">V1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">// Concatenate every other element of 4-element vectors V1 and V2.</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">V2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="c1">// Concatenate every other element of 8-element vectors V1 and V2.</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">V2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>

<span class="c1">// Shuffle v1 with some elements being undefined</span>
<span class="n">__builtin_shufflevector</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The first two arguments to <tt class="docutils literal"><span class="pre">__builtin_shufflevector</span></tt> are vectors that have
the same element type.  The remaining arguments are a list of integers that
specify the elements indices of the first two vectors that should be extracted
and returned in a new vector.  These element indices are numbered sequentially
starting with the first vector, continuing into the second vector.  Thus, if
<tt class="docutils literal"><span class="pre">vec1</span></tt> is a 4-element vector, index 5 would refer to the second element of
<tt class="docutils literal"><span class="pre">vec2</span></tt>. An index of -1 can be used to indicate that the corresponding element
in the returned vector is a don&#8217;t care and can be optimized by the backend.</p>
<p>The result of <tt class="docutils literal"><span class="pre">__builtin_shufflevector</span></tt> is a vector with the same element
type as <tt class="docutils literal"><span class="pre">vec1</span></tt>/<tt class="docutils literal"><span class="pre">vec2</span></tt> but that has an element count equal to the number of
indices specified.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_shufflevector)</span></tt>.</p>
</div>
<div class="section" id="builtin-convertvector">
<span id="langext-builtin-convertvector"></span><h3><tt class="docutils literal"><span class="pre">__builtin_convertvector</span></tt><a class="headerlink" href="#builtin-convertvector" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_convertvector</span></tt> is used to express generic vector
type-conversion operations. The input vector and the output vector
type must have the same number of elements.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_convertvector</span><span class="p">(</span><span class="n">src_vec</span><span class="p">,</span> <span class="n">dst_vec_type</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Examples</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="kt">double</span> <span class="n">vector4double</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">__vector_size__</span><span class="p">(</span><span class="mi">32</span><span class="p">)));</span>
<span class="k">typedef</span> <span class="kt">float</span>  <span class="n">vector4float</span>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">__vector_size__</span><span class="p">(</span><span class="mi">16</span><span class="p">)));</span>
<span class="k">typedef</span> <span class="kt">short</span>  <span class="n">vector4short</span>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">__vector_size__</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
<span class="n">vector4float</span> <span class="n">vf</span><span class="p">;</span> <span class="n">vector4short</span> <span class="n">vs</span><span class="p">;</span>

<span class="c1">// convert from a vector of 4 floats to a vector of 4 doubles.</span>
<span class="n">__builtin_convertvector</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">vector4double</span><span class="p">)</span>
<span class="c1">// equivalent to:</span>
<span class="p">(</span><span class="n">vector4double</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">vf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">vf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">vf</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">vf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">}</span>

<span class="c1">// convert from a vector of 4 shorts to a vector of 4 floats.</span>
<span class="n">__builtin_convertvector</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">vector4float</span><span class="p">)</span>
<span class="c1">// equivalent to:</span>
<span class="p">(</span><span class="n">vector4float</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">vs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">vs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The first argument to <tt class="docutils literal"><span class="pre">__builtin_convertvector</span></tt> is a vector, and the second
argument is a vector type with the same number of elements as the first
argument.</p>
<p>The result of <tt class="docutils literal"><span class="pre">__builtin_convertvector</span></tt> is a vector with the same element
type as the second argument, with a value defined in terms of the action of a
C-style cast applied to each element of the first argument.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_convertvector)</span></tt>.</p>
</div>
<div class="section" id="builtin-bitreverse">
<h3><tt class="docutils literal"><span class="pre">__builtin_bitreverse</span></tt><a class="headerlink" href="#builtin-bitreverse" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__builtin_bitreverse8</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_bitreverse16</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_bitreverse32</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_bitreverse64</span></tt></li>
</ul>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_bitreverse32</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Examples</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">uint8_t</span> <span class="n">rev_x</span> <span class="o">=</span> <span class="n">__builtin_bitreverse8</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">uint16_t</span> <span class="n">rev_x</span> <span class="o">=</span> <span class="n">__builtin_bitreverse16</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">uint32_t</span> <span class="n">rev_y</span> <span class="o">=</span> <span class="n">__builtin_bitreverse32</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="n">uint64_t</span> <span class="n">rev_z</span> <span class="o">=</span> <span class="n">__builtin_bitreverse64</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The &#8216;<tt class="docutils literal"><span class="pre">__builtin_bitreverse</span></tt>&#8216; family of builtins is used to reverse
the bitpattern of an integer value; for example <tt class="docutils literal"><span class="pre">0b10110110</span></tt> becomes
<tt class="docutils literal"><span class="pre">0b01101101</span></tt>.</p>
</div>
<div class="section" id="builtin-rotateleft">
<h3><tt class="docutils literal"><span class="pre">__builtin_rotateleft</span></tt><a class="headerlink" href="#builtin-rotateleft" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__builtin_rotateleft8</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateleft16</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateleft32</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateleft64</span></tt></li>
</ul>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_rotateleft32</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Examples</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">uint8_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateleft8</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint16_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateleft16</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint32_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateleft32</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint64_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateleft64</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The &#8216;<tt class="docutils literal"><span class="pre">__builtin_rotateleft</span></tt>&#8216; family of builtins is used to rotate
the bits in the first argument by the amount in the second argument.
For example, <tt class="docutils literal"><span class="pre">0b10000110</span></tt> rotated left by 11 becomes <tt class="docutils literal"><span class="pre">0b00110100</span></tt>.
The shift value is treated as an unsigned amount modulo the size of
the arguments. Both arguments and the result have the bitwidth specified
by the name of the builtin.</p>
<p><tt class="docutils literal"><span class="pre">__builtin_rotateright</span></tt>
_&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__builtin_rotateright8</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateright16</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateright32</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__builtin_rotateright64</span></tt></li>
</ul>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_rotateright32</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Examples</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">uint8_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateright8</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint16_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateright16</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint32_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateright32</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="n">uint64_t</span> <span class="n">rot_x</span> <span class="o">=</span> <span class="n">__builtin_rotateright64</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The &#8216;<tt class="docutils literal"><span class="pre">__builtin_rotateright</span></tt>&#8216; family of builtins is used to rotate
the bits in the first argument by the amount in the second argument.
For example, <tt class="docutils literal"><span class="pre">0b10000110</span></tt> rotated right by 3 becomes <tt class="docutils literal"><span class="pre">0b11010000</span></tt>.
The shift value is treated as an unsigned amount modulo the size of
the arguments. Both arguments and the result have the bitwidth specified
by the name of the builtin.</p>
</div>
<div class="section" id="builtin-unreachable">
<h3><tt class="docutils literal"><span class="pre">__builtin_unreachable</span></tt><a class="headerlink" href="#builtin-unreachable" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_unreachable</span></tt> is used to indicate that a specific point in the
program cannot be reached, even if the compiler might otherwise think it can.
This is useful to improve optimization and eliminates certain warnings.  For
example, without the <tt class="docutils literal"><span class="pre">__builtin_unreachable</span></tt> in the example below, the
compiler assumes that the inline asm can fall through and prints a &#8220;function
declared &#8216;<tt class="docutils literal"><span class="pre">noreturn</span></tt>&#8216; should not return&#8221; warning.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_unreachable</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Example of use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">void</span> <span class="n">myabort</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">noreturn</span><span class="p">));</span>
<span class="kt">void</span> <span class="n">myabort</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">asm</span><span class="p">(</span><span class="s">&quot;int3&quot;</span><span class="p">);</span>
  <span class="n">__builtin_unreachable</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The <tt class="docutils literal"><span class="pre">__builtin_unreachable()</span></tt> builtin has completely undefined behavior.
Since it has undefined behavior, it is a statement that it is never reached and
the optimizer can take advantage of this to produce better code.  This builtin
takes no arguments and produces a void result.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_unreachable)</span></tt>.</p>
</div>
<div class="section" id="builtin-unpredictable">
<h3><tt class="docutils literal"><span class="pre">__builtin_unpredictable</span></tt><a class="headerlink" href="#builtin-unpredictable" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_unpredictable</span></tt> is used to indicate that a branch condition is
unpredictable by hardware mechanisms such as branch prediction logic.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">__builtin_unpredictable</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example of use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="n">__builtin_unpredictable</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
   <span class="n">foo</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The <tt class="docutils literal"><span class="pre">__builtin_unpredictable()</span></tt> builtin is expected to be used with control
flow conditions such as in <tt class="docutils literal"><span class="pre">if</span></tt> and <tt class="docutils literal"><span class="pre">switch</span></tt> statements.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_unpredictable)</span></tt>.</p>
</div>
<div class="section" id="sync-swap">
<h3><tt class="docutils literal"><span class="pre">__sync_swap</span></tt><a class="headerlink" href="#sync-swap" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__sync_swap</span></tt> is used to atomically swap integers or pointers in memory.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">type</span> <span class="n">__sync_swap</span><span class="p">(</span><span class="n">type</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="n">type</span> <span class="n">value</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<p><strong>Example of Use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">int</span> <span class="n">old_value</span> <span class="o">=</span> <span class="n">__sync_swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="n">new_value</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong>:</p>
<p>The <tt class="docutils literal"><span class="pre">__sync_swap()</span></tt> builtin extends the existing <tt class="docutils literal"><span class="pre">__sync_*()</span></tt> family of
atomic intrinsics to allow code to atomically swap the current value with the
new value.  More importantly, it helps developers write more efficient and
correct code by avoiding expensive loops around
<tt class="docutils literal"><span class="pre">__sync_bool_compare_and_swap()</span></tt> or relying on the platform specific
implementation details of <tt class="docutils literal"><span class="pre">__sync_lock_test_and_set()</span></tt>.  The
<tt class="docutils literal"><span class="pre">__sync_swap()</span></tt> builtin is a full barrier.</p>
</div>
<div class="section" id="builtin-addressof">
<h3><tt class="docutils literal"><span class="pre">__builtin_addressof</span></tt><a class="headerlink" href="#builtin-addressof" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_addressof</span></tt> performs the functionality of the built-in <tt class="docutils literal"><span class="pre">&amp;</span></tt>
operator, ignoring any <tt class="docutils literal"><span class="pre">operator&amp;</span></tt> overload.  This is useful in constant
expressions in C++11, where there is no other way to take the address of an
object that overloads <tt class="docutils literal"><span class="pre">operator&amp;</span></tt>.</p>
<p><strong>Example of use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">constexpr</span> <span class="n">T</span> <span class="o">*</span><span class="n">addressof</span><span class="p">(</span><span class="n">T</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">__builtin_addressof</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="builtin-operator-new-and-builtin-operator-delete">
<h3><tt class="docutils literal"><span class="pre">__builtin_operator_new</span></tt> and <tt class="docutils literal"><span class="pre">__builtin_operator_delete</span></tt><a class="headerlink" href="#builtin-operator-new-and-builtin-operator-delete" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">__builtin_operator_new</span></tt> allocates memory just like a non-placement non-class
<em>new-expression</em>. This is exactly like directly calling the normal
non-placement <tt class="docutils literal"><span class="pre">::operator</span> <span class="pre">new</span></tt>, except that it allows certain optimizations
that the C++ standard does not permit for a direct function call to
<tt class="docutils literal"><span class="pre">::operator</span> <span class="pre">new</span></tt> (in particular, removing <tt class="docutils literal"><span class="pre">new</span></tt> / <tt class="docutils literal"><span class="pre">delete</span></tt> pairs and
merging allocations).</p>
<p>Likewise, <tt class="docutils literal"><span class="pre">__builtin_operator_delete</span></tt> deallocates memory just like a
non-class <em>delete-expression</em>, and is exactly like directly calling the normal
<tt class="docutils literal"><span class="pre">::operator</span> <span class="pre">delete</span></tt>, except that it permits optimizations. Only the unsized
form of <tt class="docutils literal"><span class="pre">__builtin_operator_delete</span></tt> is currently available.</p>
<p>These builtins are intended for use in the implementation of <tt class="docutils literal"><span class="pre">std::allocator</span></tt>
and other similar allocation libraries, and are only available in C++.</p>
</div>
<div class="section" id="multiprecision-arithmetic-builtins">
<h3>Multiprecision Arithmetic Builtins<a class="headerlink" href="#multiprecision-arithmetic-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides a set of builtins which expose multiprecision arithmetic in a
manner amenable to C. They all have the following form:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="n">x</span> <span class="o">=</span> <span class="p">...,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">...,</span> <span class="n">carryin</span> <span class="o">=</span> <span class="p">...,</span> <span class="n">carryout</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">__builtin_addc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">carryin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">carryout</span><span class="p">);</span>
</pre></div>
</div>
<p>Thus one can form a multiprecision addition chain in the following manner:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">carryin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">carryout</span><span class="p">;</span>
<span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">__builtin_addc</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">carryin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">carryout</span><span class="p">);</span>
<span class="n">carryin</span> <span class="o">=</span> <span class="n">carryout</span><span class="p">;</span>
<span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">__builtin_addc</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">carryin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">carryout</span><span class="p">);</span>
<span class="n">carryin</span> <span class="o">=</span> <span class="n">carryout</span><span class="p">;</span>
<span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">__builtin_addc</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">carryin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">carryout</span><span class="p">);</span>
<span class="n">carryin</span> <span class="o">=</span> <span class="n">carryout</span><span class="p">;</span>
<span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">__builtin_addc</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">carryin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">carryout</span><span class="p">);</span>
</pre></div>
</div>
<p>The complete list of builtins are:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">char</span>      <span class="n">__builtin_addcb</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">short</span>     <span class="n">__builtin_addcs</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span>           <span class="n">__builtin_addc</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">long</span>      <span class="n">__builtin_addcl</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">__builtin_addcll</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span>      <span class="n">__builtin_subcb</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">short</span>     <span class="n">__builtin_subcs</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span>           <span class="n">__builtin_subc</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">long</span>      <span class="n">__builtin_subcl</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">__builtin_subcll</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">carryin</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">carryout</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="checked-arithmetic-builtins">
<h3>Checked Arithmetic Builtins<a class="headerlink" href="#checked-arithmetic-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides a set of builtins that implement checked arithmetic for security
critical applications in a manner that is fast and easily expressable in C. As
an example of their usage:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">errorcode_t</span> <span class="nf">security_critical_application</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">...</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">__builtin_mul_overflow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kErrorCodeHackers</span><span class="p">;</span>
  <span class="p">...</span>
  <span class="n">use_multiply</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Clang provides the following checked arithmetic builtins:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">bool</span> <span class="n">__builtin_add_overflow</span>   <span class="p">(</span><span class="n">type1</span> <span class="n">x</span><span class="p">,</span> <span class="n">type2</span> <span class="n">y</span><span class="p">,</span> <span class="n">type3</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_sub_overflow</span>   <span class="p">(</span><span class="n">type1</span> <span class="n">x</span><span class="p">,</span> <span class="n">type2</span> <span class="n">y</span><span class="p">,</span> <span class="n">type3</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_mul_overflow</span>   <span class="p">(</span><span class="n">type1</span> <span class="n">x</span><span class="p">,</span> <span class="n">type2</span> <span class="n">y</span><span class="p">,</span> <span class="n">type3</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_uadd_overflow</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_uaddl_overflow</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_uaddll_overflow</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_usub_overflow</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_usubl_overflow</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_usubll_overflow</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_umul_overflow</span>  <span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_umull_overflow</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_umulll_overflow</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_sadd_overflow</span>  <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_saddl_overflow</span> <span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_saddll_overflow</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">sum</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_ssub_overflow</span>  <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_ssubl_overflow</span> <span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_ssubll_overflow</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">diff</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_smul_overflow</span>  <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_smull_overflow</span> <span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">__builtin_smulll_overflow</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="o">*</span><span class="n">prod</span><span class="p">);</span>
</pre></div>
</div>
<p>Each builtin performs the specified mathematical operation on the
first two arguments and stores the result in the third argument.  If
possible, the result will be equal to mathematically-correct result
and the builtin will return 0.  Otherwise, the builtin will return
1 and the result will be equal to the unique value that is equivalent
to the mathematically-correct result modulo two raised to the <em>k</em>
power, where <em>k</em> is the number of bits in the result type.  The
behavior of these builtins is well-defined for all argument values.</p>
<p>The first three builtins work generically for operands of any integer type,
including boolean types.  The operands need not have the same type as each
other, or as the result.  The other builtins may implicitly promote or
convert their operands before performing the operation.</p>
<p>Query for this feature with <tt class="docutils literal"><span class="pre">__has_builtin(__builtin_add_overflow)</span></tt>, etc.</p>
</div>
<div class="section" id="floating-point-builtins">
<h3>Floating point builtins<a class="headerlink" href="#floating-point-builtins" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="builtin-canonicalize">
<h3><tt class="docutils literal"><span class="pre">__builtin_canonicalize</span></tt><a class="headerlink" href="#builtin-canonicalize" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">double</span> <span class="n">__builtin_canonicalize</span><span class="p">(</span><span class="kt">double</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">__builtin_canonicalizef</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span>
<span class="kt">long</span> <span class="n">double__builtin_canonicalizel</span><span class="p">(</span><span class="kt">long</span> <span class="kt">double</span><span class="p">);</span>
</pre></div>
</div>
<p>Returns the platform specific canonical encoding of a floating point
number. This canonicalization is useful for implementing certain
numeric primitives such as frexp. See <a class="reference external" href="https://llvm.org/docs/LangRef.html#llvm-canonicalize-intrinsic">LLVM canonicalize intrinsic</a> for
more information on the semantics.</p>
</div>
<div class="section" id="string-builtins">
<h3>String builtins<a class="headerlink" href="#string-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides constant expression evaluation support for builtins forms of
the following functions from the C standard library <tt class="docutils literal"><span class="pre">&lt;string.h&gt;</span></tt> header:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">memchr</span></tt></li>
<li><tt class="docutils literal"><span class="pre">memcmp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">strchr</span></tt></li>
<li><tt class="docutils literal"><span class="pre">strcmp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">strlen</span></tt></li>
<li><tt class="docutils literal"><span class="pre">strncmp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wcschr</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wcscmp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wcslen</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wcsncmp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wmemchr</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wmemcmp</span></tt></li>
</ul>
<p>In each case, the builtin form has the name of the C library function prefixed
by <tt class="docutils literal"><span class="pre">__builtin_</span></tt>. Example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">__builtin_memchr</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<p>In addition to the above, one further builtin is provided:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">char</span> <span class="o">*</span><span class="n">__builtin_char_memchr</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">haystack</span><span class="p">,</span> <span class="kt">int</span> <span class="n">needle</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">__builtin_char_memchr(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></tt> is identical to
<tt class="docutils literal"><span class="pre">(char*)__builtin_memchr(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></tt> except that its use is permitted within
constant expressions in C++11 onwards (where a cast from <tt class="docutils literal"><span class="pre">void*</span></tt> to <tt class="docutils literal"><span class="pre">char*</span></tt>
is disallowed in general).</p>
<p>Support for constant expression evaluation for the above builtins be detected
with <tt class="docutils literal"><span class="pre">__has_feature(cxx_constexpr_string_builtins)</span></tt>.</p>
</div>
<div class="section" id="atomic-min-max-builtins-with-memory-ordering">
<h3>Atomic Min/Max builtins with memory ordering<a class="headerlink" href="#atomic-min-max-builtins-with-memory-ordering" title="Permalink to this headline">¶</a></h3>
<p>There are two atomic builtins with min/max in-memory comparison and swap.
The syntax and semantics are similar to GCC-compatible __atomic_* builtins.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__atomic_fetch_min</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__atomic_fetch_max</span></tt></li>
</ul>
<p>The builtins work with signed and unsigned integers and require to specify memory ordering.
The return value is the original value that was stored in memory before comparison.</p>
<p>Example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">__atomic_fetch_min</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ui</span><span class="p">,</span> <span class="n">__ATOMIC_RELAXED</span><span class="p">);</span>
</pre></div>
</div>
<p>The third argument is one of the memory ordering specifiers <tt class="docutils literal"><span class="pre">__ATOMIC_RELAXED</span></tt>,
<tt class="docutils literal"><span class="pre">__ATOMIC_CONSUME</span></tt>, <tt class="docutils literal"><span class="pre">__ATOMIC_ACQUIRE</span></tt>, <tt class="docutils literal"><span class="pre">__ATOMIC_RELEASE</span></tt>,
<tt class="docutils literal"><span class="pre">__ATOMIC_ACQ_REL</span></tt>, or <tt class="docutils literal"><span class="pre">__ATOMIC_SEQ_CST</span></tt> following C++11 memory model semantics.</p>
<p>In terms or aquire-release ordering barriers these two operations are always
considered as operations with <em>load-store</em> semantics, even when the original value
is not actually modified after comparison.</p>
</div>
<div class="section" id="c11-atomic-builtins">
<span id="langext-c11-atomic"></span><h3>__c11_atomic builtins<a class="headerlink" href="#c11-atomic-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides a set of builtins which are intended to be used to implement
C11&#8217;s <tt class="docutils literal"><span class="pre">&lt;stdatomic.h&gt;</span></tt> header.  These builtins provide the semantics of the
<tt class="docutils literal"><span class="pre">_explicit</span></tt> form of the corresponding C11 operation, and are named with a
<tt class="docutils literal"><span class="pre">__c11_</span></tt> prefix.  The supported operations, and the differences from
the corresponding C11 operations, are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">__c11_atomic_init</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_thread_fence</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_signal_fence</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_is_lock_free</span></tt> (The argument is the size of the
<tt class="docutils literal"><span class="pre">_Atomic(...)</span></tt> object, instead of its address)</li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_store</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_load</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_exchange</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_compare_exchange_strong</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_compare_exchange_weak</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_fetch_add</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_fetch_sub</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_fetch_and</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_fetch_or</span></tt></li>
<li><tt class="docutils literal"><span class="pre">__c11_atomic_fetch_xor</span></tt></li>
</ul>
<p>The macros <tt class="docutils literal"><span class="pre">__ATOMIC_RELAXED</span></tt>, <tt class="docutils literal"><span class="pre">__ATOMIC_CONSUME</span></tt>, <tt class="docutils literal"><span class="pre">__ATOMIC_ACQUIRE</span></tt>,
<tt class="docutils literal"><span class="pre">__ATOMIC_RELEASE</span></tt>, <tt class="docutils literal"><span class="pre">__ATOMIC_ACQ_REL</span></tt>, and <tt class="docutils literal"><span class="pre">__ATOMIC_SEQ_CST</span></tt> are
provided, with values corresponding to the enumerators of C11&#8217;s
<tt class="docutils literal"><span class="pre">memory_order</span></tt> enumeration.</p>
<p>(Note that Clang additionally provides GCC-compatible <tt class="docutils literal"><span class="pre">__atomic_*</span></tt>
builtins and OpenCL 2.0 <tt class="docutils literal"><span class="pre">__opencl_atomic_*</span></tt> builtins. The OpenCL 2.0
atomic builtins are an explicit form of the corresponding OpenCL 2.0
builtin function, and are named with a <tt class="docutils literal"><span class="pre">__opencl_</span></tt> prefix. The macros
<tt class="docutils literal"><span class="pre">__OPENCL_MEMORY_SCOPE_WORK_ITEM</span></tt>, <tt class="docutils literal"><span class="pre">__OPENCL_MEMORY_SCOPE_WORK_GROUP</span></tt>,
<tt class="docutils literal"><span class="pre">__OPENCL_MEMORY_SCOPE_DEVICE</span></tt>, <tt class="docutils literal"><span class="pre">__OPENCL_MEMORY_SCOPE_ALL_SVM_DEVICES</span></tt>,
and <tt class="docutils literal"><span class="pre">__OPENCL_MEMORY_SCOPE_SUB_GROUP</span></tt> are provided, with values
corresponding to the enumerators of OpenCL&#8217;s <tt class="docutils literal"><span class="pre">memory_scope</span></tt> enumeration.)</p>
</div>
<div class="section" id="low-level-arm-exclusive-memory-builtins">
<h3>Low-level ARM exclusive memory builtins<a class="headerlink" href="#low-level-arm-exclusive-memory-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides overloaded builtins giving direct access to the three key ARM
instructions for implementing atomic operations.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">T</span> <span class="n">__builtin_arm_ldrex</span><span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="n">T</span> <span class="n">__builtin_arm_ldaex</span><span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">__builtin_arm_strex</span><span class="p">(</span><span class="n">T</span> <span class="n">val</span><span class="p">,</span> <span class="k">volatile</span> <span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">__builtin_arm_stlex</span><span class="p">(</span><span class="n">T</span> <span class="n">val</span><span class="p">,</span> <span class="k">volatile</span> <span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">__builtin_arm_clrex</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<p>The types <tt class="docutils literal"><span class="pre">T</span></tt> currently supported are:</p>
<ul class="simple">
<li>Integer types with width at most 64 bits (or 128 bits on AArch64).</li>
<li>Floating-point types</li>
<li>Pointer types.</li>
</ul>
<p>Note that the compiler does not guarantee it will not insert stores which clear
the exclusive monitor in between an <tt class="docutils literal"><span class="pre">ldrex</span></tt> type operation and its paired
<tt class="docutils literal"><span class="pre">strex</span></tt>. In practice this is only usually a risk when the extra store is on
the same cache line as the variable being modified and Clang will only insert
stack stores on its own, so it is best not to use these operations on variables
with automatic storage duration.</p>
<p>Also, loads and stores may be implicit in code written between the <tt class="docutils literal"><span class="pre">ldrex</span></tt> and
<tt class="docutils literal"><span class="pre">strex</span></tt>. Clang will not necessarily mitigate the effects of these either, so
care should be exercised.</p>
<p>For these reasons the higher level atomic primitives should be preferred where
possible.</p>
</div>
<div class="section" id="non-temporal-load-store-builtins">
<h3>Non-temporal load/store builtins<a class="headerlink" href="#non-temporal-load-store-builtins" title="Permalink to this headline">¶</a></h3>
<p>Clang provides overloaded builtins allowing generation of non-temporal memory
accesses.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">T</span> <span class="n">__builtin_nontemporal_load</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">__builtin_nontemporal_store</span><span class="p">(</span><span class="n">T</span> <span class="n">value</span><span class="p">,</span> <span class="n">T</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</pre></div>
</div>
<p>The types <tt class="docutils literal"><span class="pre">T</span></tt> currently supported are:</p>
<ul class="simple">
<li>Integer types.</li>
<li>Floating-point types.</li>
<li>Vector types.</li>
</ul>
<p>Note that the compiler does not guarantee that non-temporal loads or stores
will be used.</p>
</div>
<div class="section" id="c-coroutines-support-builtins">
<h3>C++ Coroutines support builtins<a class="headerlink" href="#c-coroutines-support-builtins" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a work in progress. Compatibility across Clang/LLVM releases is not
guaranteed.</p>
</div>
<p>Clang provides experimental builtins to support C++ Coroutines as defined by
<a class="reference external" href="http://wg21.link/P0057">http://wg21.link/P0057</a>. The following four are intended to be used by the
standard library to implement <cite>std::experimental::coroutine_handle</cite> type.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span>  <span class="n">__builtin_coro_resume</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">void</span>  <span class="n">__builtin_coro_destroy</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="n">bool</span>  <span class="n">__builtin_coro_done</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="kt">void</span> <span class="o">*</span><span class="n">__builtin_coro_promise</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">alignment</span><span class="p">,</span> <span class="n">bool</span> <span class="n">from_promise</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example of use</strong>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">template</span> <span class="o">&lt;&gt;</span> <span class="k">struct</span> <span class="n">coroutine_handle</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kt">void</span> <span class="n">resume</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">__builtin_coro_resume</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span> <span class="p">}</span>
  <span class="kt">void</span> <span class="n">destroy</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="n">__builtin_coro_destroy</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span> <span class="p">}</span>
  <span class="kt">bool</span> <span class="n">done</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">__builtin_coro_done</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span> <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="k">protected</span><span class="o">:</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">Promise</span><span class="o">&gt;</span> <span class="k">struct</span> <span class="n">coroutine_handle</span> <span class="o">:</span> <span class="n">coroutine_handle</span><span class="o">&lt;&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="n">Promise</span> <span class="o">&amp;</span><span class="n">promise</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">Promise</span> <span class="o">*&gt;</span><span class="p">(</span>
      <span class="n">__builtin_coro_promise</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">alignof</span><span class="p">(</span><span class="n">Promise</span><span class="p">),</span> <span class="cm">/*from-promise=*/</span><span class="kc">false</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">static</span> <span class="n">coroutine_handle</span> <span class="n">from_promise</span><span class="p">(</span><span class="n">Promise</span> <span class="o">&amp;</span><span class="n">promise</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">coroutine_handle</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">__builtin_coro_promise</span><span class="p">(</span><span class="o">&amp;</span><span class="n">promise</span><span class="p">,</span> <span class="n">alignof</span><span class="p">(</span><span class="n">Promise</span><span class="p">),</span>
                                                    <span class="cm">/*from-promise=*/</span><span class="kc">true</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Other coroutine builtins are either for internal clang use or for use during
development of the coroutine feature. See <a class="reference external" href="https://llvm.org/docs/Coroutines.html#intrinsics">Coroutines in LLVM</a> for
more information on their semantics. Note that builtins matching the intrinsics
that take token as the first parameter (llvm.coro.begin, llvm.coro.alloc,
llvm.coro.free and llvm.coro.suspend) omit the token parameter and fill it to
an appropriate value during the emission.</p>
<p><strong>Syntax</strong>:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">size_t</span> <span class="n">__builtin_coro_size</span><span class="p">()</span>
<span class="kt">void</span>  <span class="o">*</span><span class="n">__builtin_coro_frame</span><span class="p">()</span>
<span class="kt">void</span>  <span class="o">*</span><span class="n">__builtin_coro_free</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">coro_frame</span><span class="p">)</span>

<span class="kt">void</span>  <span class="o">*</span><span class="n">__builtin_coro_id</span><span class="p">(</span><span class="kt">int</span> <span class="n">align</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">promise</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">fnaddr</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">parts</span><span class="p">)</span>
<span class="n">bool</span>   <span class="n">__builtin_coro_alloc</span><span class="p">()</span>
<span class="kt">void</span>  <span class="o">*</span><span class="n">__builtin_coro_begin</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">memory</span><span class="p">)</span>
<span class="kt">void</span>   <span class="n">__builtin_coro_end</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">coro_frame</span><span class="p">,</span> <span class="n">bool</span> <span class="n">unwind</span><span class="p">)</span>
<span class="kt">char</span>   <span class="n">__builtin_coro_suspend</span><span class="p">(</span><span class="n">bool</span> <span class="n">final</span><span class="p">)</span>
<span class="n">bool</span>   <span class="n">__builtin_coro_param</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">original</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">copy</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that there is no builtin matching the <cite>llvm.coro.save</cite> intrinsic. LLVM
automatically will insert one if the first argument to <cite>llvm.coro.suspend</cite> is
token <cite>none</cite>. If a user calls <cite>__builin_suspend</cite>, clang will insert <cite>token none</cite>
as the first argument to the intrinsic.</p>
</div>
</div>
<div class="section" id="non-standard-c-11-attributes">
<h2><a class="toc-backref" href="#id16">Non-standard C++11 Attributes</a><a class="headerlink" href="#non-standard-c-11-attributes" title="Permalink to this headline">¶</a></h2>
<p>Clang&#8217;s non-standard C++11 attributes live in the <tt class="docutils literal"><span class="pre">clang</span></tt> attribute
namespace.</p>
<p>Clang supports GCC&#8217;s <tt class="docutils literal"><span class="pre">gnu</span></tt> attribute namespace. All GCC attributes which
are accepted with the <tt class="docutils literal"><span class="pre">__attribute__((foo))</span></tt> syntax are also accepted as
<tt class="docutils literal"><span class="pre">[[gnu::foo]]</span></tt>. This only extends to attributes which are specified by GCC
(see the list of <a class="reference external" href="http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html">GCC function attributes</a>, <a class="reference external" href="http://gcc.gnu.org/onlinedocs/gcc/Variable-Attributes.html">GCC variable
attributes</a>, and
<a class="reference external" href="http://gcc.gnu.org/onlinedocs/gcc/Type-Attributes.html">GCC type attributes</a>). As with the GCC
implementation, these attributes must appertain to the <em>declarator-id</em> in a
declaration, which means they must go either at the start of the declaration or
immediately after the name being declared.</p>
<p>For example, this applies the GNU <tt class="docutils literal"><span class="pre">unused</span></tt> attribute to <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">f</span></tt>, and
also applies the GNU <tt class="docutils literal"><span class="pre">noreturn</span></tt> attribute to <tt class="docutils literal"><span class="pre">f</span></tt>.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="p">[[</span><span class="n">gnu</span><span class="o">::</span><span class="n">unused</span><span class="p">]]</span> <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">f</span> <span class="p">[[</span><span class="n">gnu</span><span class="o">::</span><span class="n">noreturn</span><span class="p">]]</span> <span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="target-specific-extensions">
<h2><a class="toc-backref" href="#id17">Target-Specific Extensions</a><a class="headerlink" href="#target-specific-extensions" title="Permalink to this headline">¶</a></h2>
<p>Clang supports some language features conditionally on some targets.</p>
<div class="section" id="arm-aarch64-language-extensions">
<h3>ARM/AArch64 Language Extensions<a class="headerlink" href="#arm-aarch64-language-extensions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="memory-barrier-intrinsics">
<h4>Memory Barrier Intrinsics<a class="headerlink" href="#memory-barrier-intrinsics" title="Permalink to this headline">¶</a></h4>
<p>Clang implements the <tt class="docutils literal"><span class="pre">__dmb</span></tt>, <tt class="docutils literal"><span class="pre">__dsb</span></tt> and <tt class="docutils literal"><span class="pre">__isb</span></tt> intrinsics as defined
in the <a class="reference external" href="http://infocenter.arm.com/help/topic/com.arm.doc.ihi0053c/IHI0053C_acle_2_0.pdf">ARM C Language Extensions Release 2.0</a>.
Note that these intrinsics are implemented as motion barriers that block
reordering of memory accesses and side effect instructions. Other instructions
like simple arithmetic may be reordered around the intrinsic. If you expect to
have no reordering at all, use inline assembly instead.</p>
</div>
</div>
<div class="section" id="x86-x86-64-language-extensions">
<h3>X86/X86-64 Language Extensions<a class="headerlink" href="#x86-x86-64-language-extensions" title="Permalink to this headline">¶</a></h3>
<p>The X86 backend has these language extensions:</p>
<div class="section" id="memory-references-to-specified-segments">
<h4>Memory references to specified segments<a class="headerlink" href="#memory-references-to-specified-segments" title="Permalink to this headline">¶</a></h4>
<p>Annotating a pointer with address space #256 causes it to be code generated
relative to the X86 GS segment register, address space #257 causes it to be
relative to the X86 FS segment, and address space #258 causes it to be
relative to the X86 SS segment.  Note that this is a very very low-level
feature that should only be used if you know what you&#8217;re doing (for example in
an OS kernel).</p>
<p>Here is an example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#define GS_RELATIVE __attribute__((address_space(256)))</span>
<span class="kt">int</span> <span class="n">foo</span><span class="p">(</span><span class="kt">int</span> <span class="n">GS_RELATIVE</span> <span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">*</span><span class="n">P</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Which compiles to (on X86-32):</p>
<div class="highlight-gas"><div class="highlight"><pre><span class="nl">_foo:</span>
        <span class="nf">movl</span>    <span class="mi">4</span><span class="p">(</span><span class="nv">%esp</span><span class="p">),</span> <span class="nv">%eax</span>
        <span class="nf">movl</span>    <span class="nv">%gs</span><span class="p">:(</span><span class="nv">%eax</span><span class="p">),</span> <span class="nv">%eax</span>
        <span class="nf">ret</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extensions-for-static-analysis">
<h2><a class="toc-backref" href="#id18">Extensions for Static Analysis</a><a class="headerlink" href="#extensions-for-static-analysis" title="Permalink to this headline">¶</a></h2>
<p>Clang supports additional attributes that are useful for documenting program
invariants and rules for static analysis tools, such as the <a class="reference external" href="https://clang-analyzer.llvm.org/">Clang Static
Analyzer</a>. These attributes are documented
in the analyzer&#8217;s <a class="reference external" href="https://clang-analyzer.llvm.org/annotations.html">list of source-level annotations</a>.</p>
</div>
<div class="section" id="extensions-for-dynamic-analysis">
<h2><a class="toc-backref" href="#id19">Extensions for Dynamic Analysis</a><a class="headerlink" href="#extensions-for-dynamic-analysis" title="Permalink to this headline">¶</a></h2>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(address_sanitizer)</span></tt> to check if the code is being built
with <a class="reference internal" href="AddressSanitizer.html"><em>AddressSanitizer</em></a>.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(thread_sanitizer)</span></tt> to check if the code is being built
with <a class="reference internal" href="ThreadSanitizer.html"><em>ThreadSanitizer</em></a>.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(memory_sanitizer)</span></tt> to check if the code is being built
with <a class="reference internal" href="MemorySanitizer.html"><em>MemorySanitizer</em></a>.</p>
<p>Use <tt class="docutils literal"><span class="pre">__has_feature(safe_stack)</span></tt> to check if the code is being built
with <a class="reference internal" href="SafeStack.html"><em>SafeStack</em></a>.</p>
</div>
<div class="section" id="extensions-for-selectively-disabling-optimization">
<h2><a class="toc-backref" href="#id20">Extensions for selectively disabling optimization</a><a class="headerlink" href="#extensions-for-selectively-disabling-optimization" title="Permalink to this headline">¶</a></h2>
<p>Clang provides a mechanism for selectively disabling optimizations in functions
and methods.</p>
<p>To disable optimizations in a single function definition, the GNU-style or C++11
non-standard attribute <tt class="docutils literal"><span class="pre">optnone</span></tt> can be used.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// The following functions will not be optimized.</span>
<span class="c1">// GNU-style attribute</span>
<span class="n">__attribute__</span><span class="p">((</span><span class="n">optnone</span><span class="p">))</span> <span class="kt">int</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ... code</span>
<span class="p">}</span>
<span class="c1">// C++11 attribute</span>
<span class="p">[[</span><span class="n">clang</span><span class="o">::</span><span class="n">optnone</span><span class="p">]]</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ... code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To facilitate disabling optimization for a range of function definitions, a
range-based pragma is provided. Its syntax is <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">optimize</span></tt>
followed by <tt class="docutils literal"><span class="pre">off</span></tt> or <tt class="docutils literal"><span class="pre">on</span></tt>.</p>
<p>All function definitions in the region between an <tt class="docutils literal"><span class="pre">off</span></tt> and the following
<tt class="docutils literal"><span class="pre">on</span></tt> will be decorated with the <tt class="docutils literal"><span class="pre">optnone</span></tt> attribute unless doing so would
conflict with explicit attributes already present on the function (e.g. the
ones that control inlining).</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang optimize off</span>
<span class="c1">// This function will be decorated with optnone.</span>
<span class="kt">int</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ... code</span>
<span class="p">}</span>

<span class="c1">// optnone conflicts with always_inline, so bar() will not be decorated.</span>
<span class="n">__attribute__</span><span class="p">((</span><span class="n">always_inline</span><span class="p">))</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ... code</span>
<span class="p">}</span>
<span class="cp">#pragma clang optimize on</span>
</pre></div>
</div>
<p>If no <tt class="docutils literal"><span class="pre">on</span></tt> is found to close an <tt class="docutils literal"><span class="pre">off</span></tt> region, the end of the region is the
end of the compilation unit.</p>
<p>Note that a stray <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">optimize</span> <span class="pre">on</span></tt> does not selectively enable
additional optimizations when compiling at low optimization levels. This feature
can only be used to selectively disable optimizations.</p>
<p>The pragma has an effect on functions only at the point of their definition; for
function templates, this means that the state of the pragma at the point of an
instantiation is not necessarily relevant. Consider the following example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="n">twice</span><span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#pragma clang optimize off</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="n">thrice</span><span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">container</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">twice</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">thrice</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#pragma clang optimize on</span>
</pre></div>
</div>
<p>In this example, the definition of the template function <tt class="docutils literal"><span class="pre">twice</span></tt> is outside
the pragma region, whereas the definition of <tt class="docutils literal"><span class="pre">thrice</span></tt> is inside the region.
The <tt class="docutils literal"><span class="pre">container</span></tt> function is also in the region and will not be optimized, but
it causes the instantiation of <tt class="docutils literal"><span class="pre">twice</span></tt> and <tt class="docutils literal"><span class="pre">thrice</span></tt> with an <tt class="docutils literal"><span class="pre">int</span></tt> type; of
these two instantiations, <tt class="docutils literal"><span class="pre">twice</span></tt> will be optimized (because its definition
was outside the region) and <tt class="docutils literal"><span class="pre">thrice</span></tt> will not be optimized.</p>
</div>
<div class="section" id="extensions-for-loop-hint-optimizations">
<h2><a class="toc-backref" href="#id21">Extensions for loop hint optimizations</a><a class="headerlink" href="#extensions-for-loop-hint-optimizations" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">loop</span></tt> directive is used to specify hints for optimizing the
subsequent for, while, do-while, or c++11 range-based for loop. The directive
provides options for vectorization, interleaving, unrolling and
distribution. Loop hints can be specified before any loop and will be ignored if
the optimization is not safe to apply.</p>
<div class="section" id="vectorization-and-interleaving">
<h3>Vectorization and Interleaving<a class="headerlink" href="#vectorization-and-interleaving" title="Permalink to this headline">¶</a></h3>
<p>A vectorized loop performs multiple iterations of the original loop
in parallel using vector instructions. The instruction set of the target
processor determines which vector instructions are available and their vector
widths. This restricts the types of loops that can be vectorized. The vectorizer
automatically determines if the loop is safe and profitable to vectorize. A
vector instruction cost model is used to select the vector width.</p>
<p>Interleaving multiple loop iterations allows modern processors to further
improve instruction-level parallelism (ILP) using advanced hardware features,
such as multiple execution units and out-of-order execution. The vectorizer uses
a cost model that depends on the register pressure and generated code size to
select the interleaving count.</p>
<p>Vectorization is enabled by <tt class="docutils literal"><span class="pre">vectorize(enable)</span></tt> and interleaving is enabled
by <tt class="docutils literal"><span class="pre">interleave(enable)</span></tt>. This is useful when compiling with <tt class="docutils literal"><span class="pre">-Os</span></tt> to
manually enable vectorization or interleaving.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop vectorize(enable)</span>
<span class="cp">#pragma clang loop interleave(enable)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The vector width is specified by <tt class="docutils literal"><span class="pre">vectorize_width(_value_)</span></tt> and the interleave
count is specified by <tt class="docutils literal"><span class="pre">interleave_count(_value_)</span></tt>, where
_value_ is a positive integer. This is useful for specifying the optimal
width/count of the set of target architectures supported by your application.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop vectorize_width(2)</span>
<span class="cp">#pragma clang loop interleave_count(2)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Specifying a width/count of 1 disables the optimization, and is equivalent to
<tt class="docutils literal"><span class="pre">vectorize(disable)</span></tt> or <tt class="docutils literal"><span class="pre">interleave(disable)</span></tt>.</p>
</div>
<div class="section" id="loop-unrolling">
<h3>Loop Unrolling<a class="headerlink" href="#loop-unrolling" title="Permalink to this headline">¶</a></h3>
<p>Unrolling a loop reduces the loop control overhead and exposes more
opportunities for ILP. Loops can be fully or partially unrolled. Full unrolling
eliminates the loop and replaces it with an enumerated sequence of loop
iterations. Full unrolling is only possible if the loop trip count is known at
compile time. Partial unrolling replicates the loop body within the loop and
reduces the trip count.</p>
<p>If <tt class="docutils literal"><span class="pre">unroll(enable)</span></tt> is specified the unroller will attempt to fully unroll the
loop if the trip count is known at compile time. If the fully unrolled code size
is greater than an internal limit the loop will be partially unrolled up to this
limit. If the trip count is not known at compile time the loop will be partially
unrolled with a heuristically chosen unroll factor.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop unroll(enable)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">unroll(full)</span></tt> is specified the unroller will attempt to fully unroll the
loop if the trip count is known at compile time identically to
<tt class="docutils literal"><span class="pre">unroll(enable)</span></tt>. However, with <tt class="docutils literal"><span class="pre">unroll(full)</span></tt> the loop will not be unrolled
if the loop count is not known at compile time.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop unroll(full)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The unroll count can be specified explicitly with <tt class="docutils literal"><span class="pre">unroll_count(_value_)</span></tt> where
_value_ is a positive integer. If this value is greater than the trip count the
loop will be fully unrolled. Otherwise the loop is partially unrolled subject
to the same code size limit as with <tt class="docutils literal"><span class="pre">unroll(enable)</span></tt>.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop unroll_count(8)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Unrolling of a loop can be prevented by specifying <tt class="docutils literal"><span class="pre">unroll(disable)</span></tt>.</p>
</div>
<div class="section" id="loop-distribution">
<h3>Loop Distribution<a class="headerlink" href="#loop-distribution" title="Permalink to this headline">¶</a></h3>
<p>Loop Distribution allows splitting a loop into multiple loops.  This is
beneficial for example when the entire loop cannot be vectorized but some of the
resulting loops can.</p>
<p>If <tt class="docutils literal"><span class="pre">distribute(enable))</span></tt> is specified and the loop has memory dependencies
that inhibit vectorization, the compiler will attempt to isolate the offending
operations into a new loop.  This optimization is not enabled by default, only
loops marked with the pragma are considered.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop distribute(enable)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="nl">S1:</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="nl">S2:</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This loop will be split into two loops between statements S1 and S2.  The
second loop containing S2 will be vectorized.</p>
<p>Loop Distribution is currently not enabled by default in the optimizer because
it can hurt performance in some cases.  For example, instruction-level
parallelism could be reduced by sequentializing the execution of the
statements S1 and S2 above.</p>
<p>If Loop Distribution is turned on globally with
<tt class="docutils literal"><span class="pre">-mllvm</span> <span class="pre">-enable-loop-distribution</span></tt>, specifying <tt class="docutils literal"><span class="pre">distribute(disable)</span></tt> can
be used the disable it on a per-loop basis.</p>
</div>
<div class="section" id="additional-information">
<h3>Additional Information<a class="headerlink" href="#additional-information" title="Permalink to this headline">¶</a></h3>
<p>For convenience multiple loop hints can be specified on a single line.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang loop vectorize_width(4) interleave_count(8)</span>
<span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If an optimization cannot be applied any hints that apply to it will be ignored.
For example, the hint <tt class="docutils literal"><span class="pre">vectorize_width(4)</span></tt> is ignored if the loop is not
proven safe to vectorize. To identify and diagnose optimization issues use
<cite>-Rpass</cite>, <cite>-Rpass-missed</cite>, and <cite>-Rpass-analysis</cite> command line options. See the
user guide for details.</p>
</div>
</div>
<div class="section" id="extensions-to-specify-floating-point-flags">
<h2><a class="toc-backref" href="#id22">Extensions to specify floating-point flags</a><a class="headerlink" href="#extensions-to-specify-floating-point-flags" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">fp</span></tt> pragma allows floating-point options to be specified
for a section of the source code. This pragma can only appear at file scope or
at the start of a compound statement (excluding comments). When using within a
compound statement, the pragma is active within the scope of the compound
statement.</p>
<p>Currently, only FP contraction can be controlled with the pragma. <tt class="docutils literal"><span class="pre">#pragma</span>
<span class="pre">clang</span> <span class="pre">fp</span> <span class="pre">contract</span></tt> specifies whether the compiler should contract a multiply
and an addition (or subtraction) into a fused FMA operation when supported by
the target.</p>
<p>The pragma can take three values: <tt class="docutils literal"><span class="pre">on</span></tt>, <tt class="docutils literal"><span class="pre">fast</span></tt> and <tt class="docutils literal"><span class="pre">off</span></tt>.  The <tt class="docutils literal"><span class="pre">on</span></tt>
option is identical to using <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">STDC</span> <span class="pre">FP_CONTRACT(ON)</span></tt> and it allows
fusion as specified the language standard.  The <tt class="docutils literal"><span class="pre">fast</span></tt> option allows fusiong
in cases when the language standard does not make this possible (e.g. across
statements in C)</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">for</span><span class="p">(...)</span> <span class="p">{</span>
  <span class="cp">#pragma clang fp contract(fast)</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The pragma can also be used with <tt class="docutils literal"><span class="pre">off</span></tt> which turns FP contraction off for a
section of the code. This can be useful when fast contraction is otherwise
enabled for the translation unit with the <tt class="docutils literal"><span class="pre">-ffp-contract=fast</span></tt> flag.</p>
</div>
<div class="section" id="specifying-an-attribute-for-multiple-declarations-pragma-clang-attribute">
<h2><a class="toc-backref" href="#id23">Specifying an attribute for multiple declarations (#pragma clang attribute)</a><a class="headerlink" href="#specifying-an-attribute-for-multiple-declarations-pragma-clang-attribute" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span></tt> directive can be used to apply an attribute to
multiple declarations. The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span> <span class="pre">push</span></tt> variation of the
directive pushes a new &#8220;scope&#8221; of <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span></tt> that attributes
can be added to. The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span> <span class="pre">(...)</span></tt> variation adds an
attribute to that scope, and the <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span> <span class="pre">pop</span></tt> variation pops
the scope. You can also use <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span> <span class="pre">push</span> <span class="pre">(...)</span></tt>, which is a
shorthand for when you want to add one attribute to a new scope. Multiple push
directives can be nested inside each other.</p>
<p>The attributes that are used in the <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span></tt> directives
can be written using the GNU-style syntax:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang attribute push (__attribute__((annotate(&quot;custom&quot;))), apply_to = function)</span>

<span class="kt">void</span> <span class="n">function</span><span class="p">();</span> <span class="c1">// The function now has the annotate(&quot;custom&quot;) attribute</span>

<span class="cp">#pragma clang attribute pop</span>
</pre></div>
</div>
<p>The attributes can also be written using the C++11 style syntax:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang attribute push ([[noreturn]], apply_to = function)</span>

<span class="kt">void</span> <span class="n">function</span><span class="p">();</span> <span class="c1">// The function now has the [[noreturn]] attribute</span>

<span class="cp">#pragma clang attribute pop</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">__declspec</span></tt> style syntax is also supported:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang attribute push (__declspec(dllexport), apply_to = function)</span>

<span class="kt">void</span> <span class="n">function</span><span class="p">();</span> <span class="c1">// The function now has the __declspec(dllexport) attribute</span>

<span class="cp">#pragma clang attribute pop</span>
</pre></div>
</div>
<p>A single push directive accepts only one attribute regardless of the syntax
used.</p>
<p>Because multiple push directives can be nested, if you&#8217;re writing a macro that
expands to <tt class="docutils literal"><span class="pre">_Pragma(&quot;clang</span> <span class="pre">attribute&quot;)</span></tt> it&#8217;s good hygiene (though not
required) to add a namespace to your push/pop directives. A pop directive with a
namespace will pop the innermost push that has that same namespace. This will
ensure that another macro&#8217;s <tt class="docutils literal"><span class="pre">pop</span></tt> won&#8217;t inadvertently pop your attribute. Note
that an <tt class="docutils literal"><span class="pre">pop</span></tt> without a namespace will pop the innermost <tt class="docutils literal"><span class="pre">push</span></tt> without a
namespace. <tt class="docutils literal"><span class="pre">push``es</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">namespace</span> <span class="pre">can</span> <span class="pre">only</span> <span class="pre">be</span> <span class="pre">popped</span> <span class="pre">by</span> <span class="pre">``pop</span></tt> with the
same namespace. For instance:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#define ASSUME_NORETURN_BEGIN _Pragma(&quot;clang attribute AssumeNoreturn.push ([[noreturn]], apply_to = function)&quot;)</span>
<span class="cp">#define ASSUME_NORETURN_END   _Pragma(&quot;clang attribute AssumeNoreturn.pop&quot;)</span>

<span class="cp">#define ASSUME_UNAVAILABLE_BEGIN _Pragma(&quot;clang attribute Unavailable.push (__attribute__((unavailable)), apply_to=function)&quot;)</span>
<span class="cp">#define ASSUME_UNAVAILABLE_END   _Pragma(&quot;clang attribute Unavailable.pop&quot;)</span>


<span class="n">ASSUME_NORETURN_BEGIN</span>
<span class="n">ASSUME_UNAVAILABLE_BEGIN</span>
<span class="kt">void</span> <span class="n">function</span><span class="p">();</span> <span class="c1">// function has [[noreturn]] and __attribute__((unavailable))</span>
<span class="n">ASSUME_NORETURN_END</span>
<span class="kt">void</span> <span class="n">other_function</span><span class="p">();</span> <span class="c1">// function has __attribute__((unavailable))</span>
<span class="n">ASSUME_UNAVAILABLE_END</span>
</pre></div>
</div>
<p>Without the namespaces on the macros, <tt class="docutils literal"><span class="pre">other_function</span></tt> will be annotated with
<tt class="docutils literal"><span class="pre">[[noreturn]]</span></tt> instead of <tt class="docutils literal"><span class="pre">__attribute__((unavailable))</span></tt>. This may seem like
a contrived example, but its very possible for this kind of situation to appear
in real code if the pragmas are spread out across a large file. You can test if
your version of clang supports namespaces on <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span></tt> with
<tt class="docutils literal"><span class="pre">__has_extension(pragma_clang_attribute_namespaces)</span></tt>.</p>
<div class="section" id="subject-match-rules">
<h3>Subject Match Rules<a class="headerlink" href="#subject-match-rules" title="Permalink to this headline">¶</a></h3>
<p>The set of declarations that receive a single attribute from the attribute stack
depends on the subject match rules that were specified in the pragma. Subject
match rules are specified after the attribute. The compiler expects an
identifier that corresponds to the subject set specifier. The <tt class="docutils literal"><span class="pre">apply_to</span></tt>
specifier is currently the only supported subject set specifier. It allows you
to specify match rules that form a subset of the attribute&#8217;s allowed subject
set, i.e. the compiler doesn&#8217;t require all of the attribute&#8217;s subjects. For
example, an attribute like <tt class="docutils literal"><span class="pre">[[nodiscard]]</span></tt> whose subject set includes
<tt class="docutils literal"><span class="pre">enum</span></tt>, <tt class="docutils literal"><span class="pre">record</span></tt> and <tt class="docutils literal"><span class="pre">hasType(functionType)</span></tt>, requires the presence of at
least one of these rules after <tt class="docutils literal"><span class="pre">apply_to</span></tt>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang attribute push([[nodiscard]], apply_to = enum)</span>

<span class="k">enum</span> <span class="n">Enum1</span> <span class="p">{</span> <span class="n">A1</span><span class="p">,</span> <span class="n">B1</span> <span class="p">};</span> <span class="c1">// The enum will receive [[nodiscard]]</span>

<span class="k">struct</span> <span class="n">Record1</span> <span class="p">{</span> <span class="p">};</span> <span class="c1">// The struct will *not* receive [[nodiscard]]</span>

<span class="cp">#pragma clang attribute pop</span>

<span class="cp">#pragma clang attribute push([[nodiscard]], apply_to = any(record, enum))</span>

<span class="k">enum</span> <span class="n">Enum2</span> <span class="p">{</span> <span class="n">A2</span><span class="p">,</span> <span class="n">B2</span> <span class="p">};</span> <span class="c1">// The enum will receive [[nodiscard]]</span>

<span class="k">struct</span> <span class="n">Record2</span> <span class="p">{</span> <span class="p">};</span> <span class="c1">// The struct *will* receive [[nodiscard]]</span>

<span class="cp">#pragma clang attribute pop</span>

<span class="c1">// This is an error, since [[nodiscard]] can&#39;t be applied to namespaces:</span>
<span class="cp">#pragma clang attribute push([[nodiscard]], apply_to = any(record, namespace))</span>

<span class="cp">#pragma clang attribute pop</span>
</pre></div>
</div>
<p>Multiple match rules can be specified using the <tt class="docutils literal"><span class="pre">any</span></tt> match rule, as shown
in the example above. The <tt class="docutils literal"><span class="pre">any</span></tt> rule applies attributes to all declarations
that are matched by at least one of the rules in the <tt class="docutils literal"><span class="pre">any</span></tt>. It doesn&#8217;t nest
and can&#8217;t be used inside the other match rules. Redundant match rules or rules
that conflict with one another should not be used inside of <tt class="docutils literal"><span class="pre">any</span></tt>.</p>
<p>Clang supports the following match rules:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">function</span></tt>: Can be used to apply attributes to functions. This includes C++
member functions, static functions, operators, and constructors/destructors.</li>
<li><tt class="docutils literal"><span class="pre">function(is_member)</span></tt>: Can be used to apply attributes to C++ member
functions. This includes members like static functions, operators, and
constructors/destructors.</li>
<li><tt class="docutils literal"><span class="pre">hasType(functionType)</span></tt>: Can be used to apply attributes to functions, C++
member functions, and variables/fields whose type is a function pointer. It
does not apply attributes to Objective-C methods or blocks.</li>
<li><tt class="docutils literal"><span class="pre">type_alias</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">typedef</span></tt> declarations
and C++11 type aliases.</li>
<li><tt class="docutils literal"><span class="pre">record</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">struct</span></tt>, <tt class="docutils literal"><span class="pre">class</span></tt>, and
<tt class="docutils literal"><span class="pre">union</span></tt> declarations.</li>
<li><tt class="docutils literal"><span class="pre">record(unless(is_union))</span></tt>: Can be used to apply attributes only to
<tt class="docutils literal"><span class="pre">struct</span></tt> and <tt class="docutils literal"><span class="pre">class</span></tt> declarations.</li>
<li><tt class="docutils literal"><span class="pre">enum</span></tt>: Can be be used to apply attributes to enumeration declarations.</li>
<li><tt class="docutils literal"><span class="pre">enum_constant</span></tt>: Can be used to apply attributes to enumerators.</li>
<li><tt class="docutils literal"><span class="pre">variable</span></tt>: Can be used to apply attributes to variables, including
local variables, parameters, global variables, and static member variables.
It does not apply attributes to instance member variables or Objective-C
ivars.</li>
<li><tt class="docutils literal"><span class="pre">variable(is_thread_local)</span></tt>: Can be used to apply attributes to thread-local
variables only.</li>
<li><tt class="docutils literal"><span class="pre">variable(is_global)</span></tt>: Can be used to apply attributes to global variables
only.</li>
<li><tt class="docutils literal"><span class="pre">variable(is_parameter)</span></tt>: Can be used to apply attributes to parameters
only.</li>
<li><tt class="docutils literal"><span class="pre">variable(unless(is_parameter))</span></tt>: Can be used to apply attributes to all
the variables that are not parameters.</li>
<li><tt class="docutils literal"><span class="pre">field</span></tt>: Can be used to apply attributes to non-static member variables
in a record. This includes Objective-C ivars.</li>
<li><tt class="docutils literal"><span class="pre">namespace</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">namespace</span></tt> declarations.</li>
<li><tt class="docutils literal"><span class="pre">objc_interface</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">&#64;interface</span></tt>
declarations.</li>
<li><tt class="docutils literal"><span class="pre">objc_protocol</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">&#64;protocol</span></tt>
declarations.</li>
<li><tt class="docutils literal"><span class="pre">objc_category</span></tt>: Can be used to apply attributes to category declarations,
including class extensions.</li>
<li><tt class="docutils literal"><span class="pre">objc_method</span></tt>: Can be used to apply attributes to Objective-C methods,
including instance and class methods. Implicit methods like implicit property
getters and setters do not receive the attribute.</li>
<li><tt class="docutils literal"><span class="pre">objc_method(is_instance)</span></tt>: Can be used to apply attributes to Objective-C
instance methods.</li>
<li><tt class="docutils literal"><span class="pre">objc_property</span></tt>: Can be used to apply attributes to <tt class="docutils literal"><span class="pre">&#64;property</span></tt>
declarations.</li>
<li><tt class="docutils literal"><span class="pre">block</span></tt>: Can be used to apply attributes to block declarations. This does
not include variables/fields of block pointer type.</li>
</ul>
<p>The use of <tt class="docutils literal"><span class="pre">unless</span></tt> in match rules is currently restricted to a strict set of
sub-rules that are used by the supported attributes. That means that even though
<tt class="docutils literal"><span class="pre">variable(unless(is_parameter))</span></tt> is a valid match rule,
<tt class="docutils literal"><span class="pre">variable(unless(is_thread_local))</span></tt> is not.</p>
</div>
<div class="section" id="supported-attributes">
<h3>Supported Attributes<a class="headerlink" href="#supported-attributes" title="Permalink to this headline">¶</a></h3>
<p>Not all attributes can be used with the <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">attribute</span></tt> directive.
Notably, statement attributes like <tt class="docutils literal"><span class="pre">[[fallthrough]]</span></tt> or type attributes
like <tt class="docutils literal"><span class="pre">address_space</span></tt> aren&#8217;t supported by this directive. You can determine
whether or not an attribute is supported by the pragma by referring to the
<a class="reference internal" href="AttributeReference.html"><em>individual documentation for that attribute</em></a>.</p>
<p>The attributes are applied to all matching declarations individually, even when
the attribute is semantically incorrect. The attributes that aren&#8217;t applied to
any declaration are not verified semantically.</p>
</div>
</div>
<div class="section" id="specifying-section-names-for-global-objects-pragma-clang-section">
<h2><a class="toc-backref" href="#id24">Specifying section names for global objects (#pragma clang section)</a><a class="headerlink" href="#specifying-section-names-for-global-objects-pragma-clang-section" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">section</span></tt> directive provides a means to assign section-names
to global variables, functions and static variables.</p>
<p>The section names can be specified as:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang section bss=&quot;myBSS&quot; data=&quot;myData&quot; rodata=&quot;myRodata&quot; text=&quot;myText&quot;</span>
</pre></div>
</div>
<p>The section names can be reverted back to default name by supplying an empty
string to the section kind, for example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="cp">#pragma clang section bss=&quot;&quot; data=&quot;&quot; text=&quot;&quot; rodata=&quot;&quot;</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">section</span></tt> directive obeys the following rules:</p>
<ul class="simple">
<li>The pragma applies to all global variable, statics and function declarations
from the pragma to the end of the translation unit.</li>
<li>The pragma clang section is enabled automatically, without need of any flags.</li>
<li>This feature is only defined to work sensibly for ELF targets.</li>
<li>If section name is specified through _attribute_((section(&#8220;myname&#8221;))), then
the attribute name gains precedence.</li>
<li>Global variables that are initialized to zero will be placed in the named
bss section, if one is present.</li>
<li>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">section</span></tt> directive does not does try to infer section-kind
from the name. For example, naming a section &#8220;<tt class="docutils literal"><span class="pre">.bss.mySec</span></tt>&#8221; does NOT mean
it will be a bss section name.</li>
<li>The decision about which section-kind applies to each global is taken in the back-end.
Once the section-kind is known, appropriate section name, as specified by the user using
<tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">clang</span> <span class="pre">section</span></tt> directive, is applied to that global.</li>
</ul>
</div>
<div class="section" id="specifying-linker-options-on-elf-targets">
<h2><a class="toc-backref" href="#id25">Specifying Linker Options on ELF Targets</a><a class="headerlink" href="#specifying-linker-options-on-elf-targets" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">#pragma</span> <span class="pre">comment(lib,</span> <span class="pre">...)</span></tt> directive is supported on all ELF targets.
The second parameter is the library name (without the traditional Unix prefix of
<tt class="docutils literal"><span class="pre">lib</span></tt>).  This allows you to provide an implicit link of dependent libraries.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="Toolchain.html">Assembling a Complete Toolchain</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="ObjectiveCLiterals.html">Objective-C Literals</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2007-2019, The Clang Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>